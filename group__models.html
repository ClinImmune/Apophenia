<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html> <head>
     <title>Apophenia: a library for scientific computing</title>

<!-- Google is watching. -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-134313-2";
urchinTracker();
</script>


     <link rel="stylesheet" href="typical.css" type="text/css" >
     <script  type="text/javascript" language="JavaScript" src="tree.js"></script>
</head><body>
     <center><table cellpadding=10pt>
     <tr> <td><img width=140px src=flake.gif alt="Patterns in static"></td> 
    <td><table>
     	<tr> <td><center><h2><a href="http://apophenia.info">Apophenia</a></h2></center></td></tr>
<tr><td><div class="qindex"><a class="qindex" href="index.html">&nbsp;Intro</a> | <a class="qindex" href="outline.html">Outline</a> | <a class="qindex" href="globals.html">Index</a> <!--| <a class="qindex" href="files.html">File&nbsp;List&nbsp;</a> -->  </div></td></tr></table>
	</td></tr></table></center>

    <div> <!--Doxygen generates an extra </div>.-->
<!-- Generated by Doxygen 1.7.6.1 -->
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Models</div>  </div>
</div><!--header-->
<div class="contents">
<h2><a name="define-members"></a>
Defines</h2>
<ul>
<li>#define <a class="el" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(in,...)
</ul>
<h2><a name="func-members"></a>
Functions</h2>
<ul>
<li><a class="el" href="structapop__model.html">apop_model</a> * <a class="el" href="group__models.html#gaa86381a72949fd3ffafefa87e3f51a4f">apop_model_clear</a> (<a class="el" href="structapop__data.html">apop_data</a> *data, <a class="el" href="structapop__model.html">apop_model</a> *model)
<li>void <a class="el" href="group__models.html#gab29755a86b82dfe31cdd01d55431cc09">apop_model_free</a> (<a class="el" href="structapop__model.html">apop_model</a> *free_me)
<li><a class="el" href="structapop__model.html">apop_model</a> * <a class="el" href="group__models.html#ga14f2bd54421fd6629baccb8a41ecd304">apop_model_copy</a> (<a class="el" href="structapop__model.html">apop_model</a> in)
<li><a class="el" href="structapop__model.html">apop_model</a> * <a class="el" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> m)
<li>double <a class="el" href="group__models.html#ga2510c7df8ccd834732ee208005738b0f">apop_p</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)
<li>double <a class="el" href="group__models.html#ga5e160c8d0a0ee660c89fb3f6de2af89c">apop_log_likelihood</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)
<li>void <a class="el" href="group__models.html#ga228b013bc80f308900882312cab93eb3">apop_score</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, gsl_vector *out, <a class="el" href="structapop__model.html">apop_model</a> *m)
<li><a class="el" href="structapop__model.html">apop_model</a> * <a class="el" href="group__models.html#ga92355da54ab91a8dee22192ae68a37d0">apop_parameter_model</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)
<li>void <a class="el" href="group__models.html#gaca737ed521192a76a307bbf825ab4a97">apop_draw</a> (double *out, gsl_rng *r, <a class="el" href="structapop__model.html">apop_model</a> *m)
<li>void <a class="el" href="group__models.html#ga373ccc4cb87b162d62d07a2685ccd8ba">apop_prep</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)
<li><a class="el" href="structapop__data.html">apop_data</a> * <a class="el" href="group__models.html#ga867f0b8df261866bb18e9040871c51f0">apop_predict</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)
<li>double <a class="el" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)
</ul>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga36cae46a2950eb6cfb65794cdd5dac7e"></a><!-- doxytag: member="types.h::apop_model_set_parameters" ref="ga36cae46a2950eb6cfb65794cdd5dac7e" args="(in,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a></td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">in, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Take in an unparameterized <code><a class="el" href="structapop__model.html">apop_model</a></code> and return a new <code><a class="el" href="structapop__model.html">apop_model</a></code> with the given parameters. This would have been called apop_model_parametrize, but the OED lists four acceptable spellings for parameterise, so it's not a great candidate for a function name.</p>
<p>For example, if you need a N(0,1) quickly: </p>
<div class="fragment"><pre class="fragment"><a class="code" href="structapop__model.html">apop_model</a> *std_normal = <a class="code" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(<a class="code" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a>, 0, 1);
</pre></div><p>This doesn't take in data, so it won't work with models that take the number of parameters from the data, and it will only set the vector of the model's parameter <a class="el" href="gentle.html#apop_data">apop_data</a> set. This is most standard models, so that's not a real problem either. If you have a situation where these options are out, you'll have to do something like <code><a class="el" href="structapop__model.html">apop_model</a> *new = apop_model_copy(in); apop_model_clear(your_data, in);</code> and then set <code>in-&gt;parameters</code> using your data.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>An unparameterized model, like <a class="el" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a> or <a class="el" href="group__models.html#ga9c67838a4761452cc2c9113557f2a070">apop_poisson</a>. </td></tr>
    <tr><td class="paramname">...</td><td>The list of parameters. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A copy of the input model, with parameters set. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">out-&gt;error=='d'</td><td>dimension error: you gave me a model with an indeterminate number of parameters. Set .vbase or .m2base and .m2base first, then call this fn, or use <a class="el" href="structapop__model.html">apop_model</a> *new = apop_model_copy(in); apop_model_clear(your_data, in); and then call this (because apop_model_clear sets the dimension based on your data size). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Model Documentation</h2>
<a class="anchor" id="gac5437f95ff92d27f389a7b3e27812330"></a><!-- doxytag: member="model_doc.h::apop_bernoulli" ref="gac5437f95ff92d27f389a7b3e27812330" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gac5437f95ff92d27f389a7b3e27812330">apop_bernoulli</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Bernoulli model: A single random draw with probability <img class="formulaInl" alt="$p$" src="form_19.png"/>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggac5437f95ff92d27f389a7b3e27812330a05a2e98c25fbb9e115e4cc78bc3bf4a7"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggac5437f95ff92d27f389a7b3e27812330a05a2e98c25fbb9e115e4cc78bc3bf4a7" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac5437f95ff92d27f389a7b3e27812330a248c74162be33f13446bd540e44f3d68"></a><!-- doxytag: member="Name" ref="ggac5437f95ff92d27f389a7b3e27812330a248c74162be33f13446bd540e44f3d68" args="" -->Name</em>&nbsp;</td><td>
<p><code>Bernoulli distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac5437f95ff92d27f389a7b3e27812330ae5554382c2ee4fd6cbfd4c5e220a8e8a"></a><!-- doxytag: member="Input format" ref="ggac5437f95ff92d27f389a7b3e27812330ae5554382c2ee4fd6cbfd4c5e220a8e8a" args="" -->Input format</em>&nbsp;</td><td>
<p>The matrix or vector can have any size, and I just count up zeros and non-zeros. The Bernoulli parameter <img class="formulaInl" alt="$p$" src="form_19.png"/> is the percentage of non-zero values in the matrix. Its variance is <img class="formulaInl" alt="$p(1-p)$" src="form_165.png"/>. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac5437f95ff92d27f389a7b3e27812330a938b621886f7345a34b326218bf39418"></a><!-- doxytag: member="Parameter format" ref="ggac5437f95ff92d27f389a7b3e27812330a938b621886f7345a34b326218bf39418" args="" -->Parameter format</em>&nbsp;</td><td>
<p>A vector of length one </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac5437f95ff92d27f389a7b3e27812330af794a75f7584ba55cc9ff769346f8147"></a><!-- doxytag: member="Post-estimate" ref="ggac5437f95ff92d27f389a7b3e27812330af794a75f7584ba55cc9ff769346f8147" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top"><img class="formulaInl" alt="$p$" src="form_19.png"/> is the only element in the vector. A <code>&lt;Covariance&gt;</code> page has the variance of <img class="formulaInl" alt="$p$" src="form_19.png"/> in the (0,0)th element of the matrix.  </td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports <code>log likelihood</code>.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac5437f95ff92d27f389a7b3e27812330ac79aa7de2e6e02a42a8e529a6793264e"></a><!-- doxytag: member="RNG" ref="ggac5437f95ff92d27f389a7b3e27812330ac79aa7de2e6e02a42a8e529a6793264e" args="" -->RNG</em>&nbsp;</td><td>
<p>Returns a single zero or one. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac5437f95ff92d27f389a7b3e27812330aba9f710a5bec7797075069c0b83b32f7"></a><!-- doxytag: member="Settings" ref="ggac5437f95ff92d27f389a7b3e27812330aba9f710a5bec7797075069c0b83b32f7" args="" -->Settings</em>&nbsp;</td><td>
<p>None. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gac11decb2971532ada7d2cd4982848b90"></a><!-- doxytag: member="model_doc.h::apop_beta" ref="gac11decb2971532ada7d2cd4982848b90" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gac11decb2971532ada7d2cd4982848b90">apop_beta</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Beta distribution.</p>
<p>The beta distribution has two parameters and is restricted between zero and one. You may also find <a class="el" href="types_8h.html#a69adca14afc66100168f585e05b59dcb">apop_beta_from_mean_var</a> to be useful. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggac11decb2971532ada7d2cd4982848b90a2242e71bbc8798381d9bbf4f8e3332b9"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggac11decb2971532ada7d2cd4982848b90a2242e71bbc8798381d9bbf4f8e3332b9" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac11decb2971532ada7d2cd4982848b90a939bad7138e546e374a05d679427e094"></a><!-- doxytag: member="Name" ref="ggac11decb2971532ada7d2cd4982848b90a939bad7138e546e374a05d679427e094" args="" -->Name</em>&nbsp;</td><td>
<p><code>Beta distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac11decb2971532ada7d2cd4982848b90acb8c02a21f3da6042709dee80482a41f"></a><!-- doxytag: member="Input format" ref="ggac11decb2971532ada7d2cd4982848b90acb8c02a21f3da6042709dee80482a41f" args="" -->Input format</em>&nbsp;</td><td>
<p>Any arrangement of scalar values. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac11decb2971532ada7d2cd4982848b90abf6b36f5a7b0871bca53ef89607c583f"></a><!-- doxytag: member="Parameter format" ref="ggac11decb2971532ada7d2cd4982848b90abf6b36f5a7b0871bca53ef89607c583f" args="" -->Parameter format</em>&nbsp;</td><td>
<p>a vector, v[0]= <img class="formulaInl" alt="$\alpha$" src="form_1.png"/>; v[1]= <img class="formulaInl" alt="$\beta$" src="form_2.png"/> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac11decb2971532ada7d2cd4982848b90a233145471da0e2617dc4487d090d9220"></a><!-- doxytag: member="Post-estimate" ref="ggac11decb2971532ada7d2cd4982848b90a233145471da0e2617dc4487d090d9220" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports <code>log likelihood</code>.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggac11decb2971532ada7d2cd4982848b90a0cf356d574f4179201e2c441f2c11854"></a><!-- doxytag: member="RNG" ref="ggac11decb2971532ada7d2cd4982848b90a0cf356d574f4179201e2c441f2c11854" args="" -->RNG</em>&nbsp;</td><td>
<p>Produces a scalar <img class="formulaInl" alt="$\in[0,1]$" src="form_164.png"/>. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga20017e88fda3695f093279c8191f48e3"></a><!-- doxytag: member="model_doc.h::apop_binomial" ref="ga20017e88fda3695f093279c8191f48e3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga20017e88fda3695f093279c8191f48e3">apop_binomial</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The multi-draw generalization of the Bernoulli; the two-bin special case of the <a class="el" href="group__models.html#gacd7823e794194d3646d586484833882a">Multinomial distribution</a>. This differs from the <a class="el" href="group__models.html#gacd7823e794194d3646d586484833882a">apop_multinomial</a> only in the input data format.</p>
<p>It is implemented as an alias of the <a class="el" href="group__models.html#gacd7823e794194d3646d586484833882a">apop_multinomial</a> model, except that it has a CDF, <code>.vbase==2</code> and <code>.dsize==1</code> (i.e., we know it has two parameters and a draw returns a scalar). </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga20017e88fda3695f093279c8191f48e3a647fe00b652c49a4317b5453f697462d"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga20017e88fda3695f093279c8191f48e3a647fe00b652c49a4317b5453f697462d" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Log likelihood </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">RNG </td><td class="memitem">D  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga20017e88fda3695f093279c8191f48e3a67c36e9eef40d99c79fbee04282874c4"></a><!-- doxytag: member="Input format" ref="gga20017e88fda3695f093279c8191f48e3a67c36e9eef40d99c79fbee04282874c4" args="" -->Input format</em>&nbsp;</td><td>
<p>Each row of the matrix is one observation, consisting of two elements. The number of draws of type zero (sometimes read as `misses' or `failures') are in column zero, the number of draws of type one (`hits', `successes') in column one. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga20017e88fda3695f093279c8191f48e3ac96e7d7825c0df6dbb6d2c68b146cff6"></a><!-- doxytag: member="Parameter format" ref="gga20017e88fda3695f093279c8191f48e3ac96e7d7825c0df6dbb6d2c68b146cff6" args="" -->Parameter format</em>&nbsp;</td><td>
<p>a vector, v[0]= <img class="formulaInl" alt="$n$" src="form_9.png"/>; v[1]= <img class="formulaInl" alt="$p_1$" src="form_163.png"/>. Thus, <img class="formulaInl" alt="$p_0$" src="form_148.png"/> isn't written down; see <a class="el" href="group__models.html#gacd7823e794194d3646d586484833882a">apop_multinomial</a> for further discussion. If you input $v[1]&gt;1$ and <code>apop_opts.verbose &gt;=1</code>, the log likelihood function will throw a warning. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga20017e88fda3695f093279c8191f48e3a5c455ce0e63d280252bdd43cf0ba8f7a"></a><!-- doxytag: member="Post-estimate" ref="gga20017e88fda3695f093279c8191f48e3a5c455ce0e63d280252bdd43cf0ba8f7a" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga20017e88fda3695f093279c8191f48e3a952f9efe79f2f37f95d8b2c43ffd64d7"></a><!-- doxytag: member="RNG" ref="gga20017e88fda3695f093279c8191f48e3a952f9efe79f2f37f95d8b2c43ffd64d7" args="" -->RNG</em>&nbsp;</td><td>
<p>The RNG returns a single number representing the success count, not a vector of length two giving both the failure bin and success bin. This is notable because it differs from the input data format, but it tends to be what people expect from a Binomial RNG. For draws with both dimensions, use a <a class="el" href="group__models.html#gacd7823e794194d3646d586484833882a">apop_multinomial</a> model with <code>.vbase =2</code>. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaae78271fc81d299c910a54d8ab3c91b5"></a><!-- doxytag: member="model_doc.h::apop_chi_squared" ref="gaae78271fc81d299c910a54d8ab3c91b5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaae78271fc81d299c910a54d8ab3c91b5">apop_chi_squared</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The <img class="formulaInl" alt="$\chi^2$" src="form_18.png"/> distribution, for descriptive purposes.</p>
<p>If you want to test a hypothesis, you probably don't need this, and should instead use <a class="el" href="asst_8h.html#a650d1ecf6f78c3bdb85c8fce71dfae05">apop_test</a>. See notes in <a class="el" href="group__tfchi.html">t-, chi-squared, F-, Wishart distributions</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaae78271fc81d299c910a54d8ab3c91b5a7aeb734d35ee8b048c79ff2659bb976e"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaae78271fc81d299c910a54d8ab3c91b5a7aeb734d35ee8b048c79ff2659bb976e" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaae78271fc81d299c910a54d8ab3c91b5ab0b477b362bd36f50629b1ff1ef6fb4d"></a><!-- doxytag: member="Name" ref="ggaae78271fc81d299c910a54d8ab3c91b5ab0b477b362bd36f50629b1ff1ef6fb4d" args="" -->Name</em>&nbsp;</td><td>
<p><code>Chi squared distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaae78271fc81d299c910a54d8ab3c91b5a7ee333771b769abce9d0e94c644ed8e5"></a><!-- doxytag: member="Input format" ref="ggaae78271fc81d299c910a54d8ab3c91b5a7ee333771b769abce9d0e94c644ed8e5" args="" -->Input format</em>&nbsp;</td><td>
<p>Unordered list of scalars in the matrix and/or vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaae78271fc81d299c910a54d8ab3c91b5a5c0b61156e3d554ec44479c759d243c7"></a><!-- doxytag: member="Parameter format" ref="ggaae78271fc81d299c910a54d8ab3c91b5a5c0b61156e3d554ec44479c759d243c7" args="" -->Parameter format</em>&nbsp;</td><td>
<p>Zeroth element of the vector is the <img class="formulaInl" alt="$df$" src="form_78.png"/>. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaae78271fc81d299c910a54d8ab3c91b5af9baf97e4b3faa7c692c870b3800502f"></a><!-- doxytag: member="Post-estimate" ref="ggaae78271fc81d299c910a54d8ab3c91b5af9baf97e4b3faa7c692c870b3800502f" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga3199e483f340d6cedaa6488565c42c78"></a><!-- doxytag: member="model_doc.h::apop_dirichlet" ref="ga3199e483f340d6cedaa6488565c42c78" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga3199e483f340d6cedaa6488565c42c78">apop_dirichlet</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A multivariate generalization of the <a class="el" href="group__models.html#gac11decb2971532ada7d2cd4982848b90">Beta distribution</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga3199e483f340d6cedaa6488565c42c78a2d8dca34652e8249f190f4a0b2623767"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga3199e483f340d6cedaa6488565c42c78a2d8dca34652e8249f190f4a0b2623767" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3199e483f340d6cedaa6488565c42c78a7726ce5b469ba40bf19164a0b876686b"></a><!-- doxytag: member="Name" ref="gga3199e483f340d6cedaa6488565c42c78a7726ce5b469ba40bf19164a0b876686b" args="" -->Name</em>&nbsp;</td><td>
<p><code>Dirichlet distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3199e483f340d6cedaa6488565c42c78a827d43397634d19fe36a7dfc7cbfc99c"></a><!-- doxytag: member="Input format" ref="gga3199e483f340d6cedaa6488565c42c78a827d43397634d19fe36a7dfc7cbfc99c" args="" -->Input format</em>&nbsp;</td><td>
<p>Each row of your data is a single observation. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3199e483f340d6cedaa6488565c42c78a870c2bbcbcf6e79a6aff5e7e54f9a7bf"></a><!-- doxytag: member="Parameter format" ref="gga3199e483f340d6cedaa6488565c42c78a870c2bbcbcf6e79a6aff5e7e54f9a7bf" args="" -->Parameter format</em>&nbsp;</td><td>
<p>The estimated parameters are in the output model's <code>parameters-&gt;vector</code>. The size of the model is determined by the width of your input data set, so later RNG draws, &amp;c will match in size. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3199e483f340d6cedaa6488565c42c78a90846e07967bf20e2a6d94592bdb6220"></a><!-- doxytag: member="Post-estimate" ref="gga3199e483f340d6cedaa6488565c42c78a90846e07967bf20e2a6d94592bdb6220" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3199e483f340d6cedaa6488565c42c78a6263009650abd6dd004697249cc51695"></a><!-- doxytag: member="RNG" ref="gga3199e483f340d6cedaa6488565c42c78a6263009650abd6dd004697249cc51695" args="" -->RNG</em>&nbsp;</td><td>
<p>A call to <code>gsl_ran_dirichlet</code>. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga76b45a5681d30906572263eeef35aeff"></a><!-- doxytag: member="model_doc.h::apop_exponential" ref="ga76b45a5681d30906572263eeef35aeff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga76b45a5681d30906572263eeef35aeff">apop_exponential</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Exponential distribution.</p>
<p><img class="formulaInl" alt="$Z(\mu,k) = \sum_k 1/\mu e^{-k/\mu} $" src="form_142.png"/> <br/>
 <img class="formulaInl" alt="$ln Z(\mu,k) = \sum_k -\ln(\mu) - k/\mu $" src="form_143.png"/> <br/>
 <img class="formulaInl" alt="$dln Z(\mu,k)/d\mu = \sum_k -1/\mu + k/(\mu^2) $" src="form_144.png"/> <br/>
</p>
<p>Some write the function as: <img class="formulaInl" alt="$Z(C,k) dx = \ln C C^{-k}. $" src="form_145.png"/> If you prefer this form, just convert your parameter via <img class="formulaInl" alt="$\mu = {1\over \ln C}$" src="form_146.png"/> (and convert back from the parameters this function gives you via <img class="formulaInl" alt="$C=\exp(1/\mu)$" src="form_147.png"/>). </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga76b45a5681d30906572263eeef35aeffa45653549aeb20c15ead16548f329d68c"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga76b45a5681d30906572263eeef35aeffa45653549aeb20c15ead16548f329d68c" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga76b45a5681d30906572263eeef35aeffa31776ff9a1a4764aad5a5c3d84808c86"></a><!-- doxytag: member="Name" ref="gga76b45a5681d30906572263eeef35aeffa31776ff9a1a4764aad5a5c3d84808c86" args="" -->Name</em>&nbsp;</td><td>
<p><code>Exponential distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga76b45a5681d30906572263eeef35aeffaccdc91386159b10c00c114d3365641c0"></a><!-- doxytag: member="Input format" ref="gga76b45a5681d30906572263eeef35aeffaccdc91386159b10c00c114d3365641c0" args="" -->Input format</em>&nbsp;</td><td>
<p>Ignores the matrix structure of the input data, so send in a 1 x N, an N x 1, or an N x M. </p>
<ul>
<li>See also <a class="el" href="types_8h.html#a8c4bb25171301f09a35c36306a7b9783">apop_data_rank_compress</a> for means of dealing with one more input data format. </li>
</ul>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga76b45a5681d30906572263eeef35aeffa3cf103dcd4a9c8f8caf17dbfcb6dfc58"></a><!-- doxytag: member="Parameter format" ref="gga76b45a5681d30906572263eeef35aeffa3cf103dcd4a9c8f8caf17dbfcb6dfc58" args="" -->Parameter format</em>&nbsp;</td><td>
<p><img class="formulaInl" alt="$\mu$" src="form_53.png"/> is in the zeroth element of the vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga76b45a5681d30906572263eeef35aeffa7136521b96e1ffb5090d563a2361a835"></a><!-- doxytag: member="Post-estimate" ref="gga76b45a5681d30906572263eeef35aeffa7136521b96e1ffb5090d563a2361a835" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports <code>log likelihood</code>.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga76b45a5681d30906572263eeef35aeffac3d98a558b07bd8b6d656a227ed361c0"></a><!-- doxytag: member="RNG" ref="gga76b45a5681d30906572263eeef35aeffac3d98a558b07bd8b6d656a227ed361c0" args="" -->RNG</em>&nbsp;</td><td>
<p>Just a wrapper for <code>gsl_ran_exponential</code>. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga76b45a5681d30906572263eeef35aeffa9394f145278a6618488fedba9e5624ad"></a><!-- doxytag: member="CDF" ref="gga76b45a5681d30906572263eeef35aeffa9394f145278a6618488fedba9e5624ad" args="" -->CDF</em>&nbsp;</td><td>
<p>Produces a single number. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga88a178ec7fceed826f72caa52eccca93"></a><!-- doxytag: member="model_doc.h::apop_f_distribution" ref="ga88a178ec7fceed826f72caa52eccca93" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga88a178ec7fceed826f72caa52eccca93">apop_f_distribution</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The F distribution, for descriptive purposes.</p>
<p>This model is under development, and is of beta-quality.</p>
<p>If you want to test a hypothesis, you probably don't need this, and should instead use <a class="el" href="asst_8h.html#a650d1ecf6f78c3bdb85c8fce71dfae05">apop_test</a>. See notes in <a class="el" href="group__tfchi.html">t-, chi-squared, F-, Wishart distributions</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga88a178ec7fceed826f72caa52eccca93ac9b27c156aac26e8d87573bd20db6388"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga88a178ec7fceed826f72caa52eccca93ac9b27c156aac26e8d87573bd20db6388" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga88a178ec7fceed826f72caa52eccca93a4b84be1fb79a6a64fe769f38f502f5bb"></a><!-- doxytag: member="Name" ref="gga88a178ec7fceed826f72caa52eccca93a4b84be1fb79a6a64fe769f38f502f5bb" args="" -->Name</em>&nbsp;</td><td>
<p><code>F distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga88a178ec7fceed826f72caa52eccca93a5a5b393fddcc7b1fa1a78c030a672ba6"></a><!-- doxytag: member="Input format" ref="gga88a178ec7fceed826f72caa52eccca93a5a5b393fddcc7b1fa1a78c030a672ba6" args="" -->Input format</em>&nbsp;</td><td>
<p>Unordered list of scalars in the matrix and/or vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga88a178ec7fceed826f72caa52eccca93a87d5e0dae55445e170a13f8af7afccc0"></a><!-- doxytag: member="Parameter format" ref="gga88a178ec7fceed826f72caa52eccca93a87d5e0dae55445e170a13f8af7afccc0" args="" -->Parameter format</em>&nbsp;</td><td>
<p>Zeroth and first elements of the vector are the <img class="formulaInl" alt="$df$" src="form_78.png"/>s. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga88a178ec7fceed826f72caa52eccca93aad09bdc8fed8cb096bda3f99805d3def"></a><!-- doxytag: member="Post-estimate" ref="gga88a178ec7fceed826f72caa52eccca93aad09bdc8fed8cb096bda3f99805d3def" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gad11b67493ee1e2038696268a38609367"></a><!-- doxytag: member="model_doc.h::apop_gamma" ref="gad11b67493ee1e2038696268a38609367" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gad11b67493ee1e2038696268a38609367">apop_gamma</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Gamma distribution</p>
<p><img class="formulaInl" alt="$G(x, a, b) = {1\over (\Gamma(a) b^a)} x^{a-1} e^{-x/b}$" src="form_133.png"/></p>
<p><img class="formulaInl" alt="$ln G(x, a, b)= -ln \Gamma(a) - a ln b + (a-1)ln(x) + -x/b$" src="form_134.png"/></p>
<p><img class="formulaInl" alt="$d ln G/ da = -\psi(a) - ln b + ln(x) $" src="form_135.png"/> (also, <img class="formulaInl" alt="$d ln \gamma = \psi$" src="form_136.png"/>)</p>
<p><img class="formulaInl" alt="$d ln G/ db = -a/b + x/(b^2) $" src="form_137.png"/> </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggad11b67493ee1e2038696268a38609367a6b7032ba6ec19d47dd8dca6b0a27a4dc"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggad11b67493ee1e2038696268a38609367a6b7032ba6ec19d47dd8dca6b0a27a4dc" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggad11b67493ee1e2038696268a38609367affeaf3980827760d876cffb753898c5c"></a><!-- doxytag: member="Name" ref="ggad11b67493ee1e2038696268a38609367affeaf3980827760d876cffb753898c5c" args="" -->Name</em>&nbsp;</td><td>
<p><code>Gamma distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggad11b67493ee1e2038696268a38609367a2ac2e3fb4fd35efa423bcd7a26f407ef"></a><!-- doxytag: member="Input format" ref="ggad11b67493ee1e2038696268a38609367a2ac2e3fb4fd35efa423bcd7a26f407ef" args="" -->Input format</em>&nbsp;</td><td>
<p>Location of data in the grid is not relevant; send it a 1 x N, N x 1, or N x M and it will all be the same.</p>
<ul>
<li>See also <a class="el" href="types_8h.html#a8c4bb25171301f09a35c36306a7b9783">apop_data_rank_compress</a> for means of dealing with one more input data format. </li>
</ul>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggad11b67493ee1e2038696268a38609367a3957dda06cb96eda2b7bbd9430e2f982"></a><!-- doxytag: member="Parameter format" ref="ggad11b67493ee1e2038696268a38609367a3957dda06cb96eda2b7bbd9430e2f982" args="" -->Parameter format</em>&nbsp;</td><td>
<p>First two elements of the vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggad11b67493ee1e2038696268a38609367ad812f56954d9a5c8ebf8a4968d2afbb4"></a><!-- doxytag: member="Post-estimate" ref="ggad11b67493ee1e2038696268a38609367ad812f56954d9a5c8ebf8a4968d2afbb4" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggad11b67493ee1e2038696268a38609367abbcf485c7c8365e0aefbde89805f64f8"></a><!-- doxytag: member="RNG" ref="ggad11b67493ee1e2038696268a38609367abbcf485c7c8365e0aefbde89805f64f8" args="" -->RNG</em>&nbsp;</td><td>
<p>Just a wrapper for <code>gsl_ran_gamma</code>.</p>
<p>See the notes for <a class="el" href="group__models.html#ga76b45a5681d30906572263eeef35aeff">apop_exponential</a> on a popular alternate form. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga8b3ad07d082de47bc9cd85661fe9fc4b"></a><!-- doxytag: member="model_doc.h::apop_improper_uniform" ref="ga8b3ad07d082de47bc9cd85661fe9fc4b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga8b3ad07d082de47bc9cd85661fe9fc4b">apop_improper_uniform</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The improper uniform returns <img class="formulaInl" alt="$P(x) = 1$" src="form_113.png"/> for every value of x, all the time (and thus, log likelihood(x)=0). It has zero parameters. It is useful, for example, as an input to Bayesian updating, to represent a fully neutral prior.</p>
<ul>
<li>See also the <a class="el" href="group__models.html#ga95be4cc3931072118a7c8ffece73fbe1">apop_uniform</a> model. </li>
</ul>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga8b3ad07d082de47bc9cd85661fe9fc4ba3a5134d5bc3d1f58ac6058e9ab294bad"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga8b3ad07d082de47bc9cd85661fe9fc4ba3a5134d5bc3d1f58ac6058e9ab294bad" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Prob. </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga8b3ad07d082de47bc9cd85661fe9fc4bac8fafb1ef91614dc553692fa17938a6b"></a><!-- doxytag: member="Name" ref="gga8b3ad07d082de47bc9cd85661fe9fc4bac8fafb1ef91614dc553692fa17938a6b" args="" -->Name</em>&nbsp;</td><td>
<p><code>Improper uniform distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga8b3ad07d082de47bc9cd85661fe9fc4bafaa690fe4d8b0f234571c8432a307d7f"></a><!-- doxytag: member="Input format" ref="gga8b3ad07d082de47bc9cd85661fe9fc4bafaa690fe4d8b0f234571c8432a307d7f" args="" -->Input format</em>&nbsp;</td><td>
<p>Ignored. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga8b3ad07d082de47bc9cd85661fe9fc4bae0bd6804b1704f48b4b82f748ee0c47a"></a><!-- doxytag: member="Parameter format" ref="gga8b3ad07d082de47bc9cd85661fe9fc4bae0bd6804b1704f48b4b82f748ee0c47a" args="" -->Parameter format</em>&nbsp;</td><td>
<p><code>NULL</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga8b3ad07d082de47bc9cd85661fe9fc4bad1c36abd121d982a1963f8c60487483b"></a><!-- doxytag: member="Post-estimate" ref="gga8b3ad07d082de47bc9cd85661fe9fc4bad1c36abd121d982a1963f8c60487483b" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top"><code>NULL</code>  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga8b3ad07d082de47bc9cd85661fe9fc4badbbfcc653f9f675cded4b381858fada6"></a><!-- doxytag: member="RNG" ref="gga8b3ad07d082de47bc9cd85661fe9fc4badbbfcc653f9f675cded4b381858fada6" args="" -->RNG</em>&nbsp;</td><td>
<p>The <code>draw</code> function makes no sense, and therefore halts if you call it. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga8b3ad07d082de47bc9cd85661fe9fc4ba0185962a48d96ee484b44816aade5803"></a><!-- doxytag: member="CDF" ref="gga8b3ad07d082de47bc9cd85661fe9fc4ba0185962a48d96ee484b44816aade5803" args="" -->CDF</em>&nbsp;</td><td>
<p>Half of the distribution is less than every given point, so the CDF always returns 0.5. One could perhaps make an argument that this should really be infinity, but a half is more in the spirit of the distribution's use to represent a lack of information. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1efcbbe0410c89401354c762363a909f"></a><!-- doxytag: member="model_doc.h::apop_iv" ref="ga1efcbbe0410c89401354c762363a909f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga1efcbbe0410c89401354c762363a909f">apop_iv</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Instrumental variable regression</p>
<p>Operates much like the <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a> model, but the input parameters also need to have a table of substitutions (like the addition of the <code>.instruments</code> setting in the example below). The vector element of the table lists the column numbers to be substituted (the dependent var is zero; first independent col is one), and then one column for each item to substitute.</p>
<ul>
<li>If the vector of your <a class="el" href="structapop__data.html">apop_data</a> set is <code>NULL</code>, then I will use the row names to find the columns to substitute. This is generally more robust and/or convenient.</li>
</ul>
<ul>
<li>If the <code>instruments</code> data set is somehow <code>NULL</code> or empty, I'll just run OLS.</li>
</ul>
<ul>
<li>Don't forget that the <a class="el" href="structapop__lm__settings.html">apop_lm_settings</a> group has a <code>destroy_data</code> setting. If you set that to <code>'y'</code>, I will overwrite the column in place, saving the trouble of copying the entire data set. </li>
</ul>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga1efcbbe0410c89401354c762363a909fa37faae138e8b4545551e8dd4b7370d7b"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga1efcbbe0410c89401354c762363a909fa37faae138e8b4545551e8dd4b7370d7b" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">RNG </td><td class="memitem">D  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Prep routine </td><td class="altcolor">M  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1efcbbe0410c89401354c762363a909fa47be6e14065fb7fb6d6798fba8fa678d"></a><!-- doxytag: member="Name" ref="gga1efcbbe0410c89401354c762363a909fa47be6e14065fb7fb6d6798fba8fa678d" args="" -->Name</em>&nbsp;</td><td>
<p><code>instrumental variables</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1efcbbe0410c89401354c762363a909faedb16fc5b73493bf31579465948ab050"></a><!-- doxytag: member="Input format" ref="gga1efcbbe0410c89401354c762363a909faedb16fc5b73493bf31579465948ab050" args="" -->Input format</em>&nbsp;</td><td>
<p>See <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a>; see <a class="el" href="dataprep.html">Data prep rules</a>. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1efcbbe0410c89401354c762363a909fa4402e3c767b970a21f563e3a20761e45"></a><!-- doxytag: member="Prep_routine" ref="gga1efcbbe0410c89401354c762363a909fa4402e3c767b970a21f563e3a20761e45" args="" -->Prep_routine</em>&nbsp;</td><td>
<p>Focuses on the data shunting. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1efcbbe0410c89401354c762363a909fafc222a2955e5658833caf10ee45f3a14"></a><!-- doxytag: member="Parameter format" ref="gga1efcbbe0410c89401354c762363a909fafc222a2955e5658833caf10ee45f3a14" args="" -->Parameter format</em>&nbsp;</td><td>
<p>As per <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1efcbbe0410c89401354c762363a909facb5b8768466b2910125cfc35dd00b103"></a><!-- doxytag: member="Post-estimate" ref="gga1efcbbe0410c89401354c762363a909facb5b8768466b2910125cfc35dd00b103" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1efcbbe0410c89401354c762363a909faf960733fbd5ee9c1523cdfd5fcdc1e16"></a><!-- doxytag: member="Examples" ref="gga1efcbbe0410c89401354c762363a909faf960733fbd5ee9c1523cdfd5fcdc1e16" args="" -->Examples</em>&nbsp;</td><td>
<div class="fragment"><pre class="fragment"><span class="comment">/* Instrumental variables are often used to deal with variables measured with noise, so</span>
<span class="comment">this example produces a data set with a column of noisy data, and a separate instrument</span>
<span class="comment">measured with greater precision, then sets up and runs an instrumental variable regression.</span>
<span class="comment"></span>
<span class="comment">To guarantee that the base data set has noise and the instrument is cleaner, the</span>
<span class="comment">procedure first generates the clean data set, then copies the first column to the</span>
<span class="comment">instrument set, then the \c add_noise function inserts Gaussian noise into the base</span>
<span class="comment">data set. Once the base set and the instrument set have been generated, the setup for</span>
<span class="comment">the IV consists of adding the relevant names and using \ref Apop_model_add_group to add a</span>
<span class="comment">\c lm (linear model) settings group with a &lt;tt&gt;.instrument= instrument_data&lt;/tt&gt; element.</span>
<span class="comment"></span>
<span class="comment">In fact, the example sets up a sequence of IV regressions, with more noise each</span>
<span class="comment">time. This sample is part of Apophenia&#39;s test suite, and so checks that the coefficients</span>
<span class="comment">are correct along the way.</span>
<span class="comment">*/</span>

<span class="preprocessor">#include &lt;apop.h&gt;</span>
<span class="preprocessor">#define Diff(L, R, eps) Apop_stopif(fabs((L)-(R)&gt;=(eps)), return, 0, &quot;%g is too different from %g (abitrary limit=%g).&quot;, (double)(L), (double)(R), eps);</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> datalen =1e4;

<span class="comment">//generate a vector that is the original vector + noise</span>
<span class="keywordtype">void</span> add_noise(gsl_vector *in, gsl_rng *r, <span class="keywordtype">double</span> size){
    <a class="code" href="structapop__model.html">apop_model</a> *nnoise = <a class="code" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(<a class="code" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a>, 0, size);
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; in-&gt;size; i++){
        <span class="keywordtype">double</span> noise;
        <a class="code" href="group__models.html#gaca737ed521192a76a307bbf825ab4a97">apop_draw</a>(&amp;noise, r, nnoise);
        <a class="code" href="group__convenience__fns.html#ga6c6853616a59a1bd26765c7ef08fb86c">apop_vector_increment</a>(in, i, noise);
    }
    <a class="code" href="group__models.html#gab29755a86b82dfe31cdd01d55431cc09">apop_model_free</a>(nnoise);
}

<span class="keywordtype">void</span> test_for_unbiased_parameter_estimates(<a class="code" href="structapop__model.html">apop_model</a> *m, <span class="keywordtype">double</span> tolerance){
        Diff(<a class="code" href="group__data__set__get.html#gae3c2f0d4bd96555e8eeb32a44511d0ac">apop_data_get</a>(m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, .row=0,.col=-1), -1.4, tolerance);
        Diff(<a class="code" href="group__data__set__get.html#gae3c2f0d4bd96555e8eeb32a44511d0ac">apop_data_get</a>(m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, .row=1,.col=-1), 2.3, tolerance);
}

<span class="keywordtype">int</span> main(){
    gsl_rng *r = <a class="code" href="group__convenience__fns.html#gada044cf02135422a9f9292b6054c86dd">apop_rng_alloc</a>(234);

    <a class="code" href="structapop__data.html">apop_data</a> *data = <a class="code" href="apop__data_8c.html#ac39d6a56933b6f084328ec5ecd5090d8">apop_data_alloc</a>(datalen, 2);
    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt; datalen; i++){
        <a class="code" href="group__data__set__get.html#ga1e7ba48032cb438271d57818b85613f2">apop_data_set</a>(data, i, 1, 100*(gsl_rng_uniform(r)-0.5));
        <a class="code" href="group__data__set__get.html#ga1e7ba48032cb438271d57818b85613f2">apop_data_set</a>(data, i, 0, -1.4 + <a class="code" href="group__data__set__get.html#gae3c2f0d4bd96555e8eeb32a44511d0ac">apop_data_get</a>(data,i,1)*2.3);
    }
    <a class="code" href="apop__name_8c.html#ae32d4f48cff7788b617d40155703ae64">apop_name_add</a>(data-&gt;names, <span class="stringliteral">&quot;dependent&quot;</span>, <span class="charliteral">&#39;c&#39;</span>);
    <a class="code" href="apop__name_8c.html#ae32d4f48cff7788b617d40155703ae64">apop_name_add</a>(data-&gt;names, <span class="stringliteral">&quot;independent&quot;</span>, <span class="charliteral">&#39;c&#39;</span>);
    <a class="code" href="structapop__model.html">apop_model</a> *oest = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(data, <a class="code" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a>);
<span class="preprocessor">    #ifndef Testing</span>
<span class="preprocessor"></span>    apop_model_show(oest);
<span class="preprocessor">    #endif</span>
<span class="preprocessor"></span>
    <span class="comment">//the data with no noise will be the instrument.</span>
    <a class="code" href="stats_8h.html#a79fc915cc70adb705029a8b9322abd7d">Apop_col</a>(data, 1, col1);
    <a class="code" href="structapop__data.html">apop_data</a> *instrumet_data  =<a class="code" href="apop__data_8c.html#ac39d6a56933b6f084328ec5ecd5090d8">apop_data_alloc</a>(data-&gt;matrix-&gt;size1, 1);
    APOP_COL(instrumet_data, 0, firstcol);
    gsl_vector_memcpy(firstcol, col1);
    <a class="code" href="apop__name_8c.html#ae32d4f48cff7788b617d40155703ae64">apop_name_add</a>(instrumet_data-&gt;names, <span class="stringliteral">&quot;independent&quot;</span>, <span class="charliteral">&#39;c&#39;</span>);
    <a class="code" href="group__settings.html#ga553b02de4ace5e6f16a8b26da777f9b9">Apop_model_add_group</a>(&amp;<a class="code" href="group__models.html#ga1efcbbe0410c89401354c762363a909f">apop_iv</a>, apop_lm, .instruments = instrumet_data);

    <span class="comment">//Now add noise to the base data four times, and estimate four IVs.</span>
    <span class="keywordtype">int</span> tries = 4;
    <a class="code" href="structapop__model.html">apop_model</a> *ests[tries];
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nscale=0; nscale&lt;tries; nscale++){
        add_noise(col1, r, nscale==0 ? 0 : pow(10, nscale-tries));
        ests[nscale] = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(data, <a class="code" href="group__models.html#ga1efcbbe0410c89401354c762363a909f">apop_iv</a>);
<span class="preprocessor">        #ifndef Testing</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> (nscale==tries-1){ <span class="comment">//print the one with the largest error.</span>
            printf(<span class="stringliteral">&quot;\nnow IV:\n&quot;</span>);
            apop_model_show(ests[nscale]);
        }
<span class="preprocessor">        #endif</span>
<span class="preprocessor"></span>    }

    <span class="comment">/* Now test. The parameter estimates are unbiased.</span>
<span class="comment">       As we add more noise, the covariances expand.</span>
<span class="comment">       Test that the ratio of one covariance matrix to the next</span>
<span class="comment">       is less than one, though these are typically very much</span>
<span class="comment">       smaller than one (as the noise is an order of magnitude </span>
<span class="comment">       larger in each case), and the ratios will be identical</span>
<span class="comment">       for each j, k below. */</span>
    test_for_unbiased_parameter_estimates(ests[0], 1e-6);
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;tries; i++){
        test_for_unbiased_parameter_estimates(ests[i], 1e-3);

        gsl_matrix *cov = <a class="code" href="apop__data_8c.html#a044771db76f0afb410a8d4f05ac51ca3">apop_data_get_page</a>(ests[i-1]-&gt;parameters, <span class="stringliteral">&quot;&lt;Covariance&gt;&quot;</span>)-&gt;matrix;
        gsl_matrix *cov2 = <a class="code" href="apop__data_8c.html#a044771db76f0afb410a8d4f05ac51ca3">apop_data_get_page</a>(ests[i]-&gt;parameters, <span class="stringliteral">&quot;&lt;Covariance&gt;&quot;</span>)-&gt;matrix;
        gsl_matrix_div_elements(cov, cov2);
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j =0; j&lt; 2; j++)
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k =0; k&lt; 2; k++)
                assert(gsl_matrix_get(cov, j, k) &lt; 1);
    }
}
</pre></div> </td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaded18b6bf8bd63a53f7b72ed5f27fdb5"></a><!-- doxytag: member="model_doc.h::apop_kernel_density" ref="gaded18b6bf8bd63a53f7b72ed5f27fdb5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaded18b6bf8bd63a53f7b72ed5f27fdb5">apop_kernel_density</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The kernel density smoothing of a PMF or histogram.</p>
<p>At each point along the histogram, put a distribution (default: Normal(0,1)) on top of the point. Sum all of these distributions to form the output distribution.</p>
<p>Elements of <a class="el" href="structapop__kernel__density__settings.html">apop_kernel_density_settings</a> that you may want to set:</p>
<ul>
<li><code>data</code> a data set, which, if not <code>NULL</code> and <code>!base_pmf</code> , will be converted to an <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a> model. </li>
<li><code>base_pmf</code> This is the preferred format for input data. It is the histogram to be smoothed. </li>
<li><code>kernelbase</code> The kernel to use for smoothing, with all parameters set and a <code>p</code> method. Popular favorites are <a class="el" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a> and <a class="el" href="group__models.html#ga95be4cc3931072118a7c8ffece73fbe1">apop_uniform</a>. </li>
<li><code>set_params</code> A function that takes in a single number and the model, and sets the parameters accordingly. The function will call this for every point in the data set. Here is the default, which is used if this is <code>NULL</code>. It simply sets the first element of the model's parameter vector to the input number; this is appropriate for a Normal distribution, where we want to center the distribution on each data point in turn.</li>
</ul>
<div class="fragment"><pre class="fragment"><span class="keywordtype">void</span> apop_set_first_param(<span class="keywordtype">double</span> in, <a class="code" href="structapop__model.html">apop_model</a> *m){
    m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>-&gt;vector-&gt;data[0] = in;
}
</pre></div><p>For a Uniform[0,1] recentered around each point, you'd want to put this function in your code:</p>
<div class="fragment"><pre class="fragment"><span class="keywordtype">void</span> set_midpoint(<span class="keywordtype">double</span> in, <a class="code" href="structapop__model.html">apop_model</a> *m){
    m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>-&gt;vector-&gt;data[0] = in-0.5;
    m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>-&gt;vector-&gt;data[1] = in+0.5;
}
</pre></div> <dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaded18b6bf8bd63a53f7b72ed5f27fdb5a24734c403b02bdc37a09a7be6535a157"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaded18b6bf8bd63a53f7b72ed5f27fdb5a24734c403b02bdc37a09a7be6535a157" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Prob. </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Log likelihood </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaded18b6bf8bd63a53f7b72ed5f27fdb5adb6a81fcf2b54bab8165696ece5227ce"></a><!-- doxytag: member="Name" ref="ggaded18b6bf8bd63a53f7b72ed5f27fdb5adb6a81fcf2b54bab8165696ece5227ce" args="" -->Name</em>&nbsp;</td><td>
<p><code>kernel density estimate</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaded18b6bf8bd63a53f7b72ed5f27fdb5ac547ac38eecf3539f87ac78a07e3fa4a"></a><!-- doxytag: member="Input format" ref="ggaded18b6bf8bd63a53f7b72ed5f27fdb5ac547ac38eecf3539f87ac78a07e3fa4a" args="" -->Input format</em>&nbsp;</td><td>
<p>I'll estimate a <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a> internally, so I follow that format, which is one observation (of any format) per line. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaded18b6bf8bd63a53f7b72ed5f27fdb5a275208d856442dc1f451495b6cd34a94"></a><!-- doxytag: member="Parameter format" ref="ggaded18b6bf8bd63a53f7b72ed5f27fdb5a275208d856442dc1f451495b6cd34a94" args="" -->Parameter format</em>&nbsp;</td><td>
<p>None </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaded18b6bf8bd63a53f7b72ed5f27fdb5aee0a88a828ea0be96cd0f7bb449626d2"></a><!-- doxytag: member="Post-estimate" ref="ggaded18b6bf8bd63a53f7b72ed5f27fdb5aee0a88a828ea0be96cd0f7bb449626d2" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaded18b6bf8bd63a53f7b72ed5f27fdb5aad44e68967d3122e159497a8f08d3afb"></a><!-- doxytag: member="RNG" ref="ggaded18b6bf8bd63a53f7b72ed5f27fdb5aad44e68967d3122e159497a8f08d3afb" args="" -->RNG</em>&nbsp;</td><td>
<p>Randomly selects a data point, then randomly draws from that sub-distribution. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaded18b6bf8bd63a53f7b72ed5f27fdb5a42cde044f09c61f56fff64afbd1bd274"></a><!-- doxytag: member="CDF" ref="ggaded18b6bf8bd63a53f7b72ed5f27fdb5a42cde044f09c61f56fff64afbd1bd274" args="" -->CDF</em>&nbsp;</td><td>
<p>Sums the CDF to the given point of all the sub-distributions. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaded18b6bf8bd63a53f7b72ed5f27fdb5a5e81725431add2f66fdc76df6883ea2f"></a><!-- doxytag: member="Examples" ref="ggaded18b6bf8bd63a53f7b72ed5f27fdb5a5e81725431add2f66fdc76df6883ea2f" args="" -->Examples</em>&nbsp;</td><td>
<p>This example sets up and uses KDEs based on a Normal and a Uniform distribution.</p>
<div class="fragment"><pre class="fragment"><span class="comment">/* This program draws ten random data points, and then produces two kernel density</span>
<span class="comment">estimates: one based on the Normal distribution and one based on the Uniform.</span>
<span class="comment"></span>
<span class="comment">It produces three outputs:</span>
<span class="comment">--stderr shows the random draws</span>
<span class="comment">--kerneldata is a file written with plot data for both KDEs</span>
<span class="comment">--stdout shows instructions to gnuplot, so you can pipe:</span>
<span class="comment">./kernel | gnuplot -persist</span>
<span class="comment"></span>
<span class="comment">Most of the code is taken up by the plot() and draw_some_data() functions, which are</span>
<span class="comment">straightforward. Notice how plot() pulls the values of the probability distributions </span>
<span class="comment">at each point along the scale.</span>
<span class="comment"></span>
<span class="comment">The set_uniform_edges function sets the max and min of a Uniform distribution so that the</span>
<span class="comment">given point is at the center of the distribution. It will be used to center the</span>
<span class="comment">distribution around each point in the original data set.</span>
<span class="comment"></span>
<span class="comment">The first KDE uses the defaults, which are based on a Normal distribution with std dev 1;</span>
<span class="comment">the second explicitly sets the .kernel and .set_fn for a Uniform.</span>
<span class="comment">*/</span>

<span class="preprocessor">#include &lt;apop.h&gt;</span>

<span class="keywordtype">void</span> set_uniform_edges(apop_data_row r, <a class="code" href="structapop__model.html">apop_model</a> *unif){
    <a class="code" href="group__data__set__get.html#ga1e7ba48032cb438271d57818b85613f2">apop_data_set</a>(unif-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, 0, -1, r.matrix_row.data[0]-0.5);
    <a class="code" href="group__data__set__get.html#ga1e7ba48032cb438271d57818b85613f2">apop_data_set</a>(unif-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, 1, -1, r.matrix_row.data[0]+0.5);
}

<span class="keywordtype">void</span> plot(<a class="code" href="structapop__model.html">apop_model</a> *k, <a class="code" href="structapop__model.html">apop_model</a> *k2){
    <a class="code" href="structapop__data.html">apop_data</a> *onept = <a class="code" href="apop__data_8c.html#ac39d6a56933b6f084328ec5ecd5090d8">apop_data_alloc</a>(0,1,1);
    FILE *outtab = fopen(<span class="stringliteral">&quot;kerneldata&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);
    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> i=0; i&lt;20; i+=0.01){
        <a class="code" href="group__data__set__get.html#ga1e7ba48032cb438271d57818b85613f2">apop_data_set</a>(onept,0,0, i);
        fprintf(outtab, <span class="stringliteral">&quot;%g %g %g\n&quot;</span>, i, <a class="code" href="group__models.html#ga2510c7df8ccd834732ee208005738b0f">apop_p</a>(onept, k), <a class="code" href="group__models.html#ga2510c7df8ccd834732ee208005738b0f">apop_p</a>(onept, k2));
    }
    fclose(outtab);
    printf(<span class="stringliteral">&quot;plot &#39;kerneldata&#39; using 1:2\n&quot;</span>
           <span class="stringliteral">&quot;replot &#39;kerneldata&#39; using 1:3\n&quot;</span>);
}

<a class="code" href="structapop__data.html">apop_data</a> *draw_some_data(){
    gsl_rng *r = <a class="code" href="group__convenience__fns.html#gada044cf02135422a9f9292b6054c86dd">apop_rng_alloc</a>(7);
    <a class="code" href="structapop__data.html">apop_data</a> *d  = <a class="code" href="apop__data_8c.html#ac39d6a56933b6f084328ec5ecd5090d8">apop_data_alloc</a>(0,10,1); 
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;10; i++)
        <a class="code" href="group__data__set__get.html#ga1e7ba48032cb438271d57818b85613f2">apop_data_set</a>(d, i, 0, gsl_rng_uniform(r)*20);
    <a class="code" href="group__apop__print.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a>(d, .output_pipe=stderr);
    <span class="keywordflow">return</span> d;
}

<span class="keywordtype">int</span> main(){
    <a class="code" href="structapop__data.html">apop_data</a> *d = draw_some_data();    
    <a class="code" href="structapop__model.html">apop_model</a> *k = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(d, <a class="code" href="group__models.html#gaded18b6bf8bd63a53f7b72ed5f27fdb5">apop_kernel_density</a>);
    <a class="code" href="structapop__model.html">apop_model</a> *k2 = <a class="code" href="group__models.html#ga14f2bd54421fd6629baccb8a41ecd304">apop_model_copy</a>(<a class="code" href="group__models.html#gaded18b6bf8bd63a53f7b72ed5f27fdb5">apop_kernel_density</a>);
    apop_model_add_group(k2, <a class="code" href="group__models.html#gaded18b6bf8bd63a53f7b72ed5f27fdb5">apop_kernel_density</a>, .base_data=d,
                                    .set_fn = set_uniform_edges,
                                    .kernel = &amp;<a class="code" href="group__models.html#ga95be4cc3931072118a7c8ffece73fbe1">apop_uniform</a>);
    plot(k, k2);
}
</pre></div> </td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaf7d01cc4076c9319036a0cce882dac62"></a><!-- doxytag: member="model_doc.h::apop_loess" ref="gaf7d01cc4076c9319036a0cce882dac62" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaf7d01cc4076c9319036a0cce882dac62">apop_loess</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Regression via loess smoothing</p>
<p>This uses a somewhat black-box routine, first written by Chamberlain, Devlin, Grosse, and Shyu in 1988, to fit a smoothed series of quadratic curves to the input data, thus producing a curve more closely fitting than a simple regression would.</p>
<p>The curve is basically impossible to describe using a short list of parameters, so the representation is in the form of the <code>predicted</code> vector of the <code>expected</code> data set; see below.</p>
<p>From the 1992 manual for the package: ``The method we will use to fit local regression models is called {<em>loess}</em>, which is short for local regression, and was chosen as the name since a loess is a deposit of fine clay or silt along a river valley, and thus is a surface of sorts. The word comes from the German löss, and is pronounced löíss.'' </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaf7d01cc4076c9319036a0cce882dac62a2a3f48c8a98bc603a60df91c2a75c42c"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaf7d01cc4076c9319036a0cce882dac62a2a3f48c8a98bc603a60df91c2a75c42c" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">RNG </td><td class="memitem">D  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="altcolor">Predict </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf7d01cc4076c9319036a0cce882dac62af413525ec75cb98449069f459b99e534"></a><!-- doxytag: member="Name" ref="ggaf7d01cc4076c9319036a0cce882dac62af413525ec75cb98449069f459b99e534" args="" -->Name</em>&nbsp;</td><td>
<p><code>Loess smoothing</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf7d01cc4076c9319036a0cce882dac62a7a1755c8ca65cf5551909f25d3b042f6"></a><!-- doxytag: member="Input format" ref="ggaf7d01cc4076c9319036a0cce882dac62a7a1755c8ca65cf5551909f25d3b042f6" args="" -->Input format</em>&nbsp;</td><td>
<p>The data is basically OLS-like: the first column of the data is the dependent variable to be explained; subsequent variables are the independent explanatory variables. Thus, your input data can either have a dependent vector plus explanatory matrix, or a matrix where the first column is the dependent variable.</p>
<p>Unlike with OLS, I won't move your original data, and I won't add a <b>1</b>, because that's not really the loess custom. You can of course set up your data that way if you like.</p>
<p>If your data set has a weights vector, I'll use it.</p>
<p>In any case, all data is copied into the model's <a class="el" href="structapop__loess__settings.html">apop_loess_settings</a>. The code is primarily FORTRAN code from 1988 converted to C; the data thus has to be converted into a relatively obsolete internal format. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf7d01cc4076c9319036a0cce882dac62a9c988ee166d5a315df1f0e410525c051"></a><!-- doxytag: member="Parameter format" ref="ggaf7d01cc4076c9319036a0cce882dac62a9c988ee166d5a315df1f0e410525c051" args="" -->Parameter format</em>&nbsp;</td><td>
<p>The parameter vector is unused. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf7d01cc4076c9319036a0cce882dac62a1b5f42491dcbc507b26f829b9c2c43b6"></a><!-- doxytag: member="Post-estimate" ref="ggaf7d01cc4076c9319036a0cce882dac62a1b5f42491dcbc507b26f829b9c2c43b6" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">None.  </td></tr>
<tr>
<td style="vertical-align:top">settings</td><td style="vertical-align:top"><p class="starttd"></p>
<p class="endtd">The <a class="el" href="structapop__loess__settings.html">apop_loess_settings</a> is filled with results (and internal processing cruft). The <code>out_model-&gt;info</code> data set has a table giving the actual, <code>predicted</code>, and <code>residual</code> columns, which is probably what you were looking for. Try: </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="group__output.html#ga9a30c437ec11a11e37e0db7f82386275">apop_data_show</a>(<a class="code" href="apop__data_8c.html#a044771db76f0afb410a8d4f05ac51ca3">apop_data_get_page</a>(output_model-&gt;info, <span class="stringliteral">&quot;&lt;Predicted&gt;&quot;</span>));
</pre></div>  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf7d01cc4076c9319036a0cce882dac62a8e78c8e11b17146fdb0f90eb273c1094"></a><!-- doxytag: member="Predict" ref="ggaf7d01cc4076c9319036a0cce882dac62a8e78c8e11b17146fdb0f90eb273c1094" args="" -->Predict</em>&nbsp;</td><td>
<p>Fills in the zeroth column (ignoring and overwriting any data there), and at the data's <code>-&gt;more</code> pointer, adds an <a class="el" href="gentle.html#apop_data">apop_data</a> set named "Confidence" (i.e., </p>
<div class="fragment"><pre class="fragment">!strcmp(outdata-&gt;more-&gt;names-&gt;title, <span class="stringliteral">&quot;Confidence&quot;</span>) == 1.
</pre></div><p>This routine is in beta testing. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaa88a402cf7d02c25c4613a74ace1b0c1"></a><!-- doxytag: member="model_doc.h::apop_logit" ref="gaa88a402cf7d02c25c4613a74ace1b0c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaa88a402cf7d02c25c4613a74ace1b0c1">apop_logit</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Logit model.</p>
<p>Apophenia makes no distinction between the bivariate logit and the multinomial logit. This does both.</p>
<p>The likelihood of choosing item <img class="formulaInl" alt="$j$" src="form_127.png"/> is: <img class="formulaInl" alt="$e^{x\beta_j}/ (\sum_i{e^{x\beta_i}})$" src="form_128.png"/></p>
<p>so the log likelihood is <img class="formulaInl" alt="$x\beta_j - ln(\sum_i{e^{x\beta_i}})$" src="form_129.png"/> </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaa88a402cf7d02c25c4613a74ace1b0c1a33e72583f7cb8578552a52b484696873"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaa88a402cf7d02c25c4613a74ace1b0c1a33e72583f7cb8578552a52b484696873" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="altcolor">Predict </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Prep routine </td><td class="altcolor">M  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa88a402cf7d02c25c4613a74ace1b0c1ababfaf1a72b65c49015531fc834dec2c"></a><!-- doxytag: member="Name" ref="ggaa88a402cf7d02c25c4613a74ace1b0c1ababfaf1a72b65c49015531fc834dec2c" args="" -->Name</em>&nbsp;</td><td>
<p><code>Logit</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa88a402cf7d02c25c4613a74ace1b0c1a734eddf4822216b6f93333920b8b4979"></a><!-- doxytag: member="Input format" ref="ggaa88a402cf7d02c25c4613a74ace1b0c1a734eddf4822216b6f93333920b8b4979" args="" -->Input format</em>&nbsp;</td><td>
<p>The first column of the data matrix this model expects is zeros, ones, ..., enumerating the factors; to get there, try <a class="el" href="stats_8h.html#a27405bd5fdf48d93c8918ca4c07ee260">apop_data_to_factors</a>; if you forget to run it, I'll run it on the first data column for you. The remaining columns are values of the independent variables. Thus, the model will return [(data columns)-1] <img class="formulaInl" alt="$\times$" src="form_158.png"/>[(option count)-1] parameters. Column names are options; row names are input variables. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa88a402cf7d02c25c4613a74ace1b0c1a025e476695fba466d30018dd5f8f4aee"></a><!-- doxytag: member="Prep_routine" ref="ggaa88a402cf7d02c25c4613a74ace1b0c1a025e476695fba466d30018dd5f8f4aee" args="" -->Prep_routine</em>&nbsp;</td><td>
<p>You will probably want to convert some column of your data into factors, via <a class="el" href="stats_8h.html#a27405bd5fdf48d93c8918ca4c07ee260">apop_data_to_factors</a>. If you do, then that adds a page of factors to your data set (and of course adjusts the data itself). If I find a factor page, I will use that info; if not, then I will run <a class="el" href="stats_8h.html#a27405bd5fdf48d93c8918ca4c07ee260">apop_data_to_factors</a> on the first column (the vector if there is one, else the first column of the matrix.)</p>
<p>Also, if there is no vector, then I will move the first column of the matrix, and replace that matrix column with a constant column of ones, just like with OLS. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa88a402cf7d02c25c4613a74ace1b0c1a2648c8cf817b5ad0f4cb16a4beef1a9e"></a><!-- doxytag: member="Parameter format" ref="ggaa88a402cf7d02c25c4613a74ace1b0c1a2648c8cf817b5ad0f4cb16a4beef1a9e" args="" -->Parameter format</em>&nbsp;</td><td>
<p>As above. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa88a402cf7d02c25c4613a74ace1b0c1a718cb24d51422a529fe758c9b972f384"></a><!-- doxytag: member="Post-estimate" ref="ggaa88a402cf7d02c25c4613a74ace1b0c1a718cb24d51422a529fe758c9b972f384" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa88a402cf7d02c25c4613a74ace1b0c1ac0510eb1eb94436465fd375db2703fcf"></a><!-- doxytag: member="RNG" ref="ggaa88a402cf7d02c25c4613a74ace1b0c1ac0510eb1eb94436465fd375db2703fcf" args="" -->RNG</em>&nbsp;</td><td>
<p>Much like the <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a> RNG, qv. Returns the category drawn.</p>
<ul>
<li>PS: Here is a nice trick used in the implementation. let <img class="formulaInl" alt="$y_i = x\beta_i$" src="form_159.png"/>. Then <p class="formulaDsp">
<img class="formulaDsp" alt="\[ln(\sum_i{e^{x\beta_i}}) = max(y_i) + ln(\sum_i{e^{y_i - max(y_i)}}).\]" src="form_160.png"/>
</p>
</li>
</ul>
<p>The elements of the sum are all now exp(something negative), so overflow won't happen, and if there's underflow, then that term must not have been very important. [This trick is attributed to Tom Minka, who implemented it in his Lightspeed Matlab toolkit.]</p>
<p>Here is an artifical example:</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;apop.h&gt;</span>

<span class="keywordtype">char</span> *testfile = <span class="stringliteral">&quot;logit_test_data&quot;</span>;

<span class="comment">//generate a fake data set.</span>
<span class="comment">//Notice how the first column is the outcome, just as with standard regression.</span>
<span class="keywordtype">void</span> write_data(){
    FILE *f = fopen(testfile, <span class="stringliteral">&quot;w&quot;</span>);
    fprintf(f, <span class="stringliteral">&quot;\</span>
<span class="stringliteral">        outcome,A, B \n\</span>
<span class="stringliteral">        0, 0, 0     \n\</span>
<span class="stringliteral">        1, 1, 1     \n\</span>
<span class="stringliteral">        1, .7, .5   \n\</span>
<span class="stringliteral">        1, .7, .3   \n\</span>
<span class="stringliteral">        1, .3, .7   \n\</span>
<span class="stringliteral">        \n\</span>
<span class="stringliteral">        1, .5, .5   \n\</span>
<span class="stringliteral">        0, .4, .4   \n\</span>
<span class="stringliteral">        0, .3, .4   \n\</span>
<span class="stringliteral">        1, .1, .3   \n\</span>
<span class="stringliteral">        1, .3, .1   &quot;</span>);
    fclose(f);
}

<span class="keywordtype">int</span> main(){
    write_data();
    <a class="code" href="structapop__data.html">apop_data</a> *d = <a class="code" href="group__conversions.html#ga630de5d4fcbe9ef13373029f5d813a97">apop_text_to_data</a>(testfile);
    <a class="code" href="group__settings.html#ga553b02de4ace5e6f16a8b26da777f9b9">Apop_model_add_group</a>(&amp;<a class="code" href="group__models.html#gaa88a402cf7d02c25c4613a74ace1b0c1">apop_logit</a>, apop_mle, .tolerance=1e-5);
    <a class="code" href="group__models.html#gaa88a402cf7d02c25c4613a74ace1b0c1">apop_logit</a>.score=NULL;
    <a class="code" href="structapop__model.html">apop_model</a> *est = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(d, <a class="code" href="group__models.html#gaa88a402cf7d02c25c4613a74ace1b0c1">apop_logit</a>);
    unlink(testfile);

    <span class="comment">/* Apophenia&#39;s test suite checks that this code produces </span>
<span class="comment">       values close to canned values. As a human, you probably </span>
<span class="comment">       just want to print the results to the screen. */</span>
<span class="preprocessor">    #ifndef Testing</span>
<span class="preprocessor"></span>        apop_model_show(est);
<span class="preprocessor">    #else</span>
<span class="preprocessor"></span>        assert(fabs(<a class="code" href="group__data__set__get.html#gae3c2f0d4bd96555e8eeb32a44511d0ac">apop_data_get</a>(est-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, .rowname=<span class="stringliteral">&quot;1&quot;</span>)- -1.155026) &lt; 1e-6);
        assert(fabs(<a class="code" href="group__data__set__get.html#gae3c2f0d4bd96555e8eeb32a44511d0ac">apop_data_get</a>(est-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, .rowname=<span class="stringliteral">&quot;A&quot;</span>)- 4.039903) &lt; 1e-6);
        assert(fabs(<a class="code" href="group__data__set__get.html#gae3c2f0d4bd96555e8eeb32a44511d0ac">apop_data_get</a>(est-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, .rowname=<span class="stringliteral">&quot;B&quot;</span>)- 1.494694) &lt; 1e-6);
<span class="preprocessor">    #endif</span>
<span class="preprocessor"></span>}
</pre></div> </td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga4a917e02f41e9c6a0ad5e084e3ca42d2"></a><!-- doxytag: member="model_doc.h::apop_lognormal" ref="ga4a917e02f41e9c6a0ad5e084e3ca42d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga4a917e02f41e9c6a0ad5e084e3ca42d2">apop_lognormal</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Lognormal distribution</p>
<p>The log likelihood function for the lognormal distribution:</p>
<p><img class="formulaInl" alt="$f = exp(-(ln(x)-\mu)^2/(2\sigma^2))/ (x\sigma\sqrt{2\pi})$" src="form_130.png"/> <img class="formulaInl" alt="$ln f = -(ln(x)-\mu)^2/(2\sigma^2) - ln(x) - ln(\sigma\sqrt{2\pi})$" src="form_131.png"/> </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga4a917e02f41e9c6a0ad5e084e3ca42d2ab7cf5e109475b5f0b2680c125389805c"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga4a917e02f41e9c6a0ad5e084e3ca42d2ab7cf5e109475b5f0b2680c125389805c" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga4a917e02f41e9c6a0ad5e084e3ca42d2a03f9f90a4557f99e7b984a8995df66d9"></a><!-- doxytag: member="Name" ref="gga4a917e02f41e9c6a0ad5e084e3ca42d2a03f9f90a4557f99e7b984a8995df66d9" args="" -->Name</em>&nbsp;</td><td>
<p><code>Lognormal distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga4a917e02f41e9c6a0ad5e084e3ca42d2a79fbaad5ca865f26fe5160a62a6a9c69"></a><!-- doxytag: member="Input format" ref="gga4a917e02f41e9c6a0ad5e084e3ca42d2a79fbaad5ca865f26fe5160a62a6a9c69" args="" -->Input format</em>&nbsp;</td><td>
<p>I use the all elements of the matrix and vector, without regard to their order. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga4a917e02f41e9c6a0ad5e084e3ca42d2a19c5a60231405a9c0310313d204501d8"></a><!-- doxytag: member="Parameter format" ref="gga4a917e02f41e9c6a0ad5e084e3ca42d2a19c5a60231405a9c0310313d204501d8" args="" -->Parameter format</em>&nbsp;</td><td>
<p>Zeroth vector element is the mean (after logging); first is the std dev (after logging) </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga4a917e02f41e9c6a0ad5e084e3ca42d2a61913e9d7d606151b839a645db92035c"></a><!-- doxytag: member="Post-estimate" ref="gga4a917e02f41e9c6a0ad5e084e3ca42d2a61913e9d7d606151b839a645db92035c" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports <code>log likelihood</code>.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga4a917e02f41e9c6a0ad5e084e3ca42d2a0714eda0c798e9a326298ffad830ae26"></a><!-- doxytag: member="RNG" ref="gga4a917e02f41e9c6a0ad5e084e3ca42d2a0714eda0c798e9a326298ffad830ae26" args="" -->RNG</em>&nbsp;</td><td>
<p>An Apophenia wrapper for the GSL's Normal RNG, exp'ed. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaf085564a8adc67ba156c4cd1db8145e3"></a><!-- doxytag: member="model_doc.h::apop_mixture" ref="gaf085564a8adc67ba156c4cd1db8145e3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaf085564a8adc67ba156c4cd1db8145e3">apop_mixture</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The mixture model transformation: a linear combination of multiple models.</p>
<p>Generated via <a class="el" href="types_8h.html#a40bb98b02fde8f8e4ab59a4d127b692f">apop_model_mixture</a>.</p>
<p>Note that a kernel density is a mixture of a large number of homogeneous models, where each is typically centered around a point in your data. For such situations, <a class="el" href="group__models.html#gaded18b6bf8bd63a53f7b72ed5f27fdb5">apop_kernel_density</a> will be easier to use.</p>
<ul>
<li>This is still in beta. Expect the interface to change a little.</li>
</ul>
<ul>
<li>You could potentially provide a list of unparameterized models, and then have <a class="el" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a> estimate the parameters of all of them at once:</li>
</ul>
<div class="fragment"><pre class="fragment">    <a class="code" href="structapop__model.html">apop_model</a> *m_blank = <a class="code" href="types_8h.html#a40bb98b02fde8f8e4ab59a4d127b692f">apop_model_mixture</a>(<a class="code" href="group__models.html#ga14f2bd54421fd6629baccb8a41ecd304">apop_model_copy</a>(<a class="code" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a>), <a class="code" href="group__models.html#ga14f2bd54421fd6629baccb8a41ecd304">apop_model_copy</a>(<a class="code" href="group__models.html#ga76b45a5681d30906572263eeef35aeff">apop_exponential</a>));
    <a class="code" href="structapop__model.html">apop_model</a> *m_estimated = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(your_data, m);
</pre></div><p>One can think of the estimation as a missing-data problem: each data point originated in one distribution or the other, and if we knew with certainty which data point came from which distribution, then the estimation problem would be trivial: just generate the subsets and call <code>apop_estimate(dataset1, model1)</code>, ..., <code>apop_estimate(datasetn, modeln)</code> separately. But the assignment of which element goes where is unknown information, which we guess at using an E-M algorithm. We're still experimenting with better algorithms.</p>
<p>In the first maximization step, I estimate the parameters of each model by sending all available data to each model's native <code>estimate</code> routine (which may or may not be a maximization). In the expectation step, I calculate the likelihood that the data point is drawn from each of the distributions (given the parameters to this point), and then assign the data point to the most likely distribution. The maximization step then re-estimates the parameters using the new selection of data points. The expectation and maximization steps alternate until convergence.</p>
<p>Note that determining to which parts of a mixture to assign a data point is a well-known hard problem, which is often not solvable--that information is basically lost.</p>
<ul>
<li>The weights are free parameters, to be estimated like any other. If you want to fix them, then use <a class="el" href="apop__fix__params_8c.html#ab4f6ca7e042ac7c09c3c01d29702a739">apop_model_fix_params</a> to do so. E.g.</li>
</ul>
<div class="fragment"><pre class="fragment">    <a class="code" href="structapop__model.html">apop_model</a> *m = <a class="code" href="types_8h.html#a40bb98b02fde8f8e4ab59a4d127b692f">apop_model_mixture</a>(<a class="code" href="group__models.html#ga14f2bd54421fd6629baccb8a41ecd304">apop_model_copy</a>(<a class="code" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a>), <a class="code" href="group__models.html#ga14f2bd54421fd6629baccb8a41ecd304">apop_model_copy</a>(<a class="code" href="group__models.html#ga76b45a5681d30906572263eeef35aeff">apop_exponential</a>));
    <a class="code" href="group__models.html#ga373ccc4cb87b162d62d07a2685ccd8ba">apop_prep</a>(NULL, m); <span class="comment">//for some models, NULL will need to be an \ref apop_data set.</span>
    gsl_vector_set_all(m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>-&gt;vector, NAN);
    gsl_vector weightsvector = gsl_vector_subvector(m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>-&gt;vector, 0, 2).vector;
    gsl_vector_set_all(&amp;weightsvector, 1);
    <a class="code" href="structapop__model.html">apop_model</a> *fixed =<a class="code" href="stats_8h.html#ab4f6ca7e042ac7c09c3c01d29702a739">apop_model_fix_params</a>(m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, m);
</pre></div> <dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaf085564a8adc67ba156c4cd1db8145e3ade8ea8fe03e8a5f5584aed3ce8185c59"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaf085564a8adc67ba156c4cd1db8145e3ade8ea8fe03e8a5f5584aed3ce8185c59" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Prep routine </td><td class="altcolor">M  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf085564a8adc67ba156c4cd1db8145e3a782aef23781c145cfd6a2fc52f501b89"></a><!-- doxytag: member="Name" ref="ggaf085564a8adc67ba156c4cd1db8145e3a782aef23781c145cfd6a2fc52f501b89" args="" -->Name</em>&nbsp;</td><td>
<p><code>Mixture of models</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf085564a8adc67ba156c4cd1db8145e3aa18b274afda98ff697a2a01801e84449"></a><!-- doxytag: member="Input format" ref="ggaf085564a8adc67ba156c4cd1db8145e3aa18b274afda98ff697a2a01801e84449" args="" -->Input format</em>&nbsp;</td><td>
<p>The same data gets sent to each of the submodels. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf085564a8adc67ba156c4cd1db8145e3a621f0b9138ed72a2f140c14b38c364f7"></a><!-- doxytag: member="Parameter format" ref="ggaf085564a8adc67ba156c4cd1db8145e3a621f0b9138ed72a2f140c14b38c364f7" args="" -->Parameter format</em>&nbsp;</td><td>
<p>You probably just want to look at the submodel parameters. The parent model's parameter list is entirely in <code>yrmodel-&gt;parameters-&gt;vector</code>. The first N are the weights, and then we have each model's parameters packed in, in turn. There are pack/unpack functions that run as needed. Given the estimated mixture model <code>m</code> over three models, the weights are: </p>
<div class="fragment"><pre class="fragment">    gsl_vector weightsvector = gsl_vector_subvector(m-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>-&gt;vector, 0, 3).vector;
</pre></div> </td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf085564a8adc67ba156c4cd1db8145e3af1d8c1e422c7cb82642981fd58e2b5e4"></a><!-- doxytag: member="Post-estimate" ref="ggaf085564a8adc67ba156c4cd1db8145e3af1d8c1e422c7cb82642981fd58e2b5e4" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf085564a8adc67ba156c4cd1db8145e3a0a2a8cbcb75d232a0d723e135e10bfab"></a><!-- doxytag: member="Settings" ref="ggaf085564a8adc67ba156c4cd1db8145e3a0a2a8cbcb75d232a0d723e135e10bfab" args="" -->Settings</em>&nbsp;</td><td>
<p><a class="el" href="structapop__mixture__settings.html">apop_mixture_settings</a> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf085564a8adc67ba156c4cd1db8145e3a4889f0cfad2dfb8b21ea142d72f68934"></a><!-- doxytag: member="Examples" ref="ggaf085564a8adc67ba156c4cd1db8145e3a4889f0cfad2dfb8b21ea142d72f68934" args="" -->Examples</em>&nbsp;</td><td>
<div class="fragment"><pre class="fragment"></pre></div> </td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gacd7823e794194d3646d586484833882a"></a><!-- doxytag: member="model_doc.h::apop_multinomial" ref="gacd7823e794194d3646d586484833882a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gacd7823e794194d3646d586484833882a">apop_multinomial</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The <img class="formulaInl" alt="$n$" src="form_9.png"/>--option generalization of the <a class="el" href="group__models.html#ga20017e88fda3695f093279c8191f48e3">Binomial distribution</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggacd7823e794194d3646d586484833882aa068d1fa8ecd43cb6054336ccf6665166"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggacd7823e794194d3646d586484833882aa068d1fa8ecd43cb6054336ccf6665166" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggacd7823e794194d3646d586484833882aabcb240df2d575c612a407518ee7cd751"></a><!-- doxytag: member="Name" ref="ggacd7823e794194d3646d586484833882aabcb240df2d575c612a407518ee7cd751" args="" -->Name</em>&nbsp;</td><td>
<p><code>Binomial distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggacd7823e794194d3646d586484833882aada7bee035b320a28dcd81dba16e3530a"></a><!-- doxytag: member="Input format" ref="ggacd7823e794194d3646d586484833882aada7bee035b320a28dcd81dba16e3530a" args="" -->Input format</em>&nbsp;</td><td>
<p>Each row of the matrix is one observation: a set of draws from a single bin. The number of draws of type zero are in column zero, the number of draws of type one in column one, et cetera.</p>
<ul>
<li>You may have a set of several Bernoulli-type draws, which could be summed together to form a single Binomial draw. See <a class="el" href="stats_8h.html#ae0c28224e10f8aacdaa2d130f96f6ba2">apop_data_to_dummies</a> to do the aggregation (using the <code>.keep_first='y'</code> option). </li>
</ul>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggacd7823e794194d3646d586484833882aa9924bce9086c9687768c2946ed9c56f0"></a><!-- doxytag: member="Parameter format" ref="ggacd7823e794194d3646d586484833882aa9924bce9086c9687768c2946ed9c56f0" args="" -->Parameter format</em>&nbsp;</td><td>
<p>The parameters are kept in the vector element of the <code><a class="el" href="structapop__model.html">apop_model</a></code> parameters element. <code>parameters-&gt;vector-&gt;data</code>[0]==n; <code>parameters-&gt;vector-&gt;data</code>[1...]==p_1....</p>
<p>The numeraire is bin zero, meaning that <img class="formulaInl" alt="$p_0$" src="form_148.png"/> is not explicitly listed, but is <img class="formulaInl" alt="$p_0=1-\sum_{i=1}^{k-1} p_i$" src="form_149.png"/>, where <img class="formulaInl" alt="$k$" src="form_46.png"/> is the number of bins. Conveniently enough, the zeroth element of the parameters vector holds <img class="formulaInl" alt="$n$" src="form_9.png"/>, and so a full probability vector can easily be produced by overwriting that first element. Continuing the above example: </p>
<div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> n = <a class="code" href="group__data__set__get.html#gae3c2f0d4bd96555e8eeb32a44511d0ac">apop_data_get</a>(estimated-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, 0, -1); 
<a class="code" href="group__data__set__get.html#ga1e7ba48032cb438271d57818b85613f2">apop_data_set</a>(estimated-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>, 0, 1 - (<a class="code" href="group__convenience__fns.html#ga7f85a98b61078ba3dc273f17eddd34a7">apop_sum</a>(estimated-&gt;<a class="code" href="structapop__model.html#ae016a9e13725e84a1188bc81c8f09e45">parameters</a>)-n)); 
</pre></div><p> And now the parameter vector is a proper list of probabilities.</p>
<ul>
<li>Because an observation is typically a single row, the value of <img class="formulaInl" alt="$N$" src="form_3.png"/> is set to equal the length of the first row (counting both vector and matrix elements, as appropriate). Thus, if your data is entirely in the vector or a one-column matrix, then the <img class="formulaInl" alt="$p$" src="form_19.png"/>s are estimated using all data, but <img class="formulaInl" alt="$N=1$" src="form_150.png"/>. The covariances are calculated accordingly, and a random draw would return a single bin. </li>
</ul>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggacd7823e794194d3646d586484833882aa19a03901e43728bb317f01fb6be46ba0"></a><!-- doxytag: member="Post-estimate" ref="ggacd7823e794194d3646d586484833882aa19a03901e43728bb317f01fb6be46ba0" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">As per the parameter format. Has a <code>&lt;Covariance&gt;</code> page with the covariance matrix for the <img class="formulaInl" alt="$p$" src="form_19.png"/>s ( <img class="formulaInl" alt="$n$" src="form_9.png"/> effectively has no variance).  </td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports <code>log likelihood</code>.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggacd7823e794194d3646d586484833882aa82a752cff9ca429d5035170b244496aa"></a><!-- doxytag: member="RNG" ref="ggacd7823e794194d3646d586484833882aa82a752cff9ca429d5035170b244496aa" args="" -->RNG</em>&nbsp;</td><td>
<p>Returns a single vector of length <img class="formulaInl" alt="$k$" src="form_46.png"/>, the result of an imaginary tossing of <img class="formulaInl" alt="$N$" src="form_3.png"/> balls into <img class="formulaInl" alt="$k$" src="form_46.png"/> urns, with the given probabilities. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaca327fbed9216d183a5673adbf831f34"></a><!-- doxytag: member="model_doc.h::apop_multinomial_probit" ref="gaca327fbed9216d183a5673adbf831f34" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaca327fbed9216d183a5673adbf831f34">apop_multinomial_probit</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Multinomial Probit model.</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000004">Deprecated:</a></b></dt><dd>Use <a class="el" href="group__models.html#ga319b8e3d5025a6fc94829a978273eb8b">apop_probit</a>, which handles multiple options. </dd></dl>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaca327fbed9216d183a5673adbf831f34a15e4477546a9ccf3fa34a7e0da6049c7"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaca327fbed9216d183a5673adbf831f34a15e4477546a9ccf3fa34a7e0da6049c7" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Log likelihood </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">RNG </td><td class="memitem">D  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaca327fbed9216d183a5673adbf831f34abf7f31ab9c498b8367a79ac2e85cbc7e"></a><!-- doxytag: member="Post-estimate" ref="ggaca327fbed9216d183a5673adbf831f34abf7f31ab9c498b8367a79ac2e85cbc7e" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga3a4389e6e2a1a2ea606f89d55ec558d3"></a><!-- doxytag: member="model_doc.h::apop_multivariate_normal" ref="ga3a4389e6e2a1a2ea606f89d55ec558d3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga3a4389e6e2a1a2ea606f89d55ec558d3">apop_multivariate_normal</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is the multivariate generalization of the Normal distribution. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga3a4389e6e2a1a2ea606f89d55ec558d3ab2197a23581768f00cc8c76044ee3b64"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga3a4389e6e2a1a2ea606f89d55ec558d3ab2197a23581768f00cc8c76044ee3b64" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Prep routine </td><td class="altcolor">M  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3a4389e6e2a1a2ea606f89d55ec558d3a3653e32f34c0e7cbee2d48e66b1b7f62"></a><!-- doxytag: member="Name" ref="gga3a4389e6e2a1a2ea606f89d55ec558d3a3653e32f34c0e7cbee2d48e66b1b7f62" args="" -->Name</em>&nbsp;</td><td>
<p><code>Multivariate normal distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3a4389e6e2a1a2ea606f89d55ec558d3a477a78c629d063a0bfa6760516adb703"></a><!-- doxytag: member="Input format" ref="gga3a4389e6e2a1a2ea606f89d55ec558d3a477a78c629d063a0bfa6760516adb703" args="" -->Input format</em>&nbsp;</td><td>
<p>Each row of the matrix is an observation. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3a4389e6e2a1a2ea606f89d55ec558d3a6a7cc6d1c86c9453b90a4b8c6619910e"></a><!-- doxytag: member="Parameter format" ref="gga3a4389e6e2a1a2ea606f89d55ec558d3a6a7cc6d1c86c9453b90a4b8c6619910e" args="" -->Parameter format</em>&nbsp;</td><td>
<p>An <code><a class="el" href="structapop__data.html">apop_data</a></code> set whose vector element is the vector of means, and whose matrix is the covariances.</p>
<p>If you had only one dimension, the mean would be a vector of size one, and the covariance matrix a <img class="formulaInl" alt="$1\times 1$" src="form_151.png"/> matrix. This differs from the setup for <a class="el" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a>, which outputs a single vector with <img class="formulaInl" alt="$\mu$" src="form_53.png"/> in element zero and <img class="formulaInl" alt="$\sigma$" src="form_70.png"/> in element one. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3a4389e6e2a1a2ea606f89d55ec558d3a4ddb085b33ead65a5ab74e4f04ed7fa6"></a><!-- doxytag: member="Post-estimate" ref="gga3a4389e6e2a1a2ea606f89d55ec558d3a4ddb085b33ead65a5ab74e4f04ed7fa6" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top"><p class="starttd">Format as above. The <code>&lt;Covariance&gt;</code> page gives the covariance matrix of the means.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports <code>log likelihood</code>.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3a4389e6e2a1a2ea606f89d55ec558d3a686e28adf99c0b3146df29c4fe59b51c"></a><!-- doxytag: member="RNG" ref="gga3a4389e6e2a1a2ea606f89d55ec558d3a686e28adf99c0b3146df29c4fe59b51c" args="" -->RNG</em>&nbsp;</td><td>
<p>The RNG fills an input array whose length is based on the input parameters.</p>
<p>The nice, easy method from Devroye, p 565 </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga3a4389e6e2a1a2ea606f89d55ec558d3ad2c7e88d079c75a65b23e900d1d5e77e"></a><!-- doxytag: member="Settings" ref="gga3a4389e6e2a1a2ea606f89d55ec558d3ad2c7e88d079c75a65b23e900d1d5e77e" args="" -->Settings</em>&nbsp;</td><td>
<p>None. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga297c2dc8dbdf4ae93fc7e10860400466"></a><!-- doxytag: member="model_doc.h::apop_normal" ref="ga297c2dc8dbdf4ae93fc7e10860400466" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Normal (Gaussian) distribution</p>
<p>You know it, it's your attractor in the limit, it's the Gaussian distribution.</p>
<p><img class="formulaInl" alt="$N(\mu,\sigma^2) = {1 \over \sqrt{2 \pi \sigma^2}} \exp (-x^2 / 2\sigma^2)$" src="form_138.png"/></p>
<p><img class="formulaInl" alt="$\ln N(\mu,\sigma^2) = (-(x-\mu)^2 / 2\sigma^2) - \ln (2 \pi \sigma^2)/2 $" src="form_139.png"/></p>
<p><img class="formulaInl" alt="$d\ln N(\mu,\sigma^2)/d\mu = (x-\mu) / \sigma^2 $" src="form_140.png"/></p>
<p><img class="formulaInl" alt="$d\ln N(\mu,\sigma^2)/d\sigma^2 = ((x-\mu)^2 / 2(\sigma^2)^2) - 1/2\sigma^2 $" src="form_141.png"/></p>
<p>See also the <a class="el" href="group__models.html#ga3a4389e6e2a1a2ea606f89d55ec558d3">apop_multivariate_normal</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga297c2dc8dbdf4ae93fc7e10860400466a7dd83848b9ff664ae707471375e09ea8"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga297c2dc8dbdf4ae93fc7e10860400466a7dd83848b9ff664ae707471375e09ea8" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="altcolor">Predict </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga297c2dc8dbdf4ae93fc7e10860400466a8d18a55306869a56903194fc458a88b1"></a><!-- doxytag: member="Name" ref="gga297c2dc8dbdf4ae93fc7e10860400466a8d18a55306869a56903194fc458a88b1" args="" -->Name</em>&nbsp;</td><td>
<p><code>Normal distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga297c2dc8dbdf4ae93fc7e10860400466a835df469e8a85283841fda4a6c5dede5"></a><!-- doxytag: member="Input format" ref="gga297c2dc8dbdf4ae93fc7e10860400466a835df469e8a85283841fda4a6c5dede5" args="" -->Input format</em>&nbsp;</td><td>
<p>I use the elements of the matrix and vector, without regard to their order or position. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga297c2dc8dbdf4ae93fc7e10860400466a544b0860a8d1b058e094b99162c034d0"></a><!-- doxytag: member="Parameter format" ref="gga297c2dc8dbdf4ae93fc7e10860400466a544b0860a8d1b058e094b99162c034d0" args="" -->Parameter format</em>&nbsp;</td><td>
<p>As is custom, parameter zero (in the vector) is the mean, parmeter one is the standard deviation (i.e., the square root of the variance). </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga297c2dc8dbdf4ae93fc7e10860400466a2d73057ebb2ce84a2ef00ac687bc3b78"></a><!-- doxytag: member="Post-estimate" ref="gga297c2dc8dbdf4ae93fc7e10860400466a2d73057ebb2ce84a2ef00ac687bc3b78" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">Zeroth vector element is <img class="formulaInl" alt="$\mu$" src="form_53.png"/>, element 1 is <img class="formulaInl" alt="$\sigma$" src="form_70.png"/>. A page is added named <code>&lt;Covariance&gt;</code> with the 2 <img class="formulaInl" alt="$\times$" src="form_158.png"/> 2 covariance matrix for these two parameters  </td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports the log likelihood. </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga297c2dc8dbdf4ae93fc7e10860400466a2ef9f1117df0a406993b1e85e80aad17"></a><!-- doxytag: member="Predict" ref="gga297c2dc8dbdf4ae93fc7e10860400466a2ef9f1117df0a406993b1e85e80aad17" args="" -->Predict</em>&nbsp;</td><td>
<p>Returns the expected value. The <code>-&gt;more</code> element holds a <a class="el" href="gentle.html#apop_data">apop_data</a> set with the title <code>&lt;Covariance&gt;</code>, whose matrix holds the covariance of the mean. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga297c2dc8dbdf4ae93fc7e10860400466ab6fcdd04005597b9148c43e8c2368537"></a><!-- doxytag: member="RNG" ref="gga297c2dc8dbdf4ae93fc7e10860400466ab6fcdd04005597b9148c43e8c2368537" args="" -->RNG</em>&nbsp;</td><td>
<p>An apophenia wrapper for the GSL's Normal RNG.</p>
<p>This one asks explicitly for a mean, and the GSL assumes zero and lets you add the mean yourself. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga297c2dc8dbdf4ae93fc7e10860400466a7babf12b316cfa6e0cfedd324aa55ddd"></a><!-- doxytag: member="Settings" ref="gga297c2dc8dbdf4ae93fc7e10860400466a7babf12b316cfa6e0cfedd324aa55ddd" args="" -->Settings</em>&nbsp;</td><td>
<p>None. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga85524b1deabd5829227888fd91740cc3"></a><!-- doxytag: member="model_doc.h::apop_ols" ref="ga85524b1deabd5829227888fd91740cc3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Ordinary least squares. Weighted least squares is also handled by this model. You can also use it for a lot of not-entirely linear models based on the form <img class="formulaInl" alt="$Y = f(x_1) + f(x_2) + ... + \epsilon$" src="form_126.png"/>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga85524b1deabd5829227888fd91740cc3ad035240969a4dc7f783ef1a5b6fbe9bc"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga85524b1deabd5829227888fd91740cc3ad035240969a4dc7f783ef1a5b6fbe9bc" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="altcolor">Predict </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Prep routine </td><td class="altcolor">M  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga85524b1deabd5829227888fd91740cc3a4e14854658e112e2eaeda9d357e4b0cf"></a><!-- doxytag: member="Name" ref="gga85524b1deabd5829227888fd91740cc3a4e14854658e112e2eaeda9d357e4b0cf" args="" -->Name</em>&nbsp;</td><td>
<p><code>Ordinary Least Squares</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga85524b1deabd5829227888fd91740cc3a623809abf09b48226a4082e67a150365"></a><!-- doxytag: member="Input format" ref="gga85524b1deabd5829227888fd91740cc3a623809abf09b48226a4082e67a150365" args="" -->Input format</em>&nbsp;</td><td>
<p>See <a class="el" href="dataprep.html">Data prep rules</a>. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga85524b1deabd5829227888fd91740cc3add8777a05983a50d90f5bdea63a4ae5b"></a><!-- doxytag: member="Prep_routine" ref="gga85524b1deabd5829227888fd91740cc3add8777a05983a50d90f5bdea63a4ae5b" args="" -->Prep_routine</em>&nbsp;</td><td>
<p>Focuses on the data shunting. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga85524b1deabd5829227888fd91740cc3afac163b35f7d221ff2758b1656d266cc"></a><!-- doxytag: member="Parameter format" ref="gga85524b1deabd5829227888fd91740cc3afac163b35f7d221ff2758b1656d266cc" args="" -->Parameter format</em>&nbsp;</td><td>
<p>A vector of OLS coefficients. coeff. zero refers to the constant column, if any. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga85524b1deabd5829227888fd91740cc3a144d3ee674f7d47c2c782d1477d4b4d8"></a><!-- doxytag: member="Post-estimate" ref="gga85524b1deabd5829227888fd91740cc3a144d3ee674f7d47c2c782d1477d4b4d8" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top"><p class="starttd">You can specify whether the data is modified with an <a class="el" href="structapop__lm__settings.html">apop_lm_settings</a> group. If so, see <a class="el" href="dataprep.html">Data prep rules</a> for details. Else, left unchanged.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top"><p class="starttd"></p>
<p>The <code>parameters</code> set will hold the coefficients; the first coefficient will be the coefficient on the constant term, and the remaining will correspond to the independent variables. It will therefore be of size <code>(data-&gt;size2)</code>.</p>
<p>I add a page named <code>&lt;Covariance&gt;</code>, which gives the covariance matrix for the estimated parameters (not the data itself).</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td style="vertical-align:top"><code>parameter models</code></td><td style="vertical-align:top">For the mean, a noncentral <img class="formulaInl" alt="$t$" src="form_10.png"/> distribution (<a class="el" href="group__models.html#ga45ce986bd5ea79c39877792bec39a304">apop_t_distribution</a>). </td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top"><p class="starttd">Reports log likelihood, and runs <a class="el" href="group__regression.html#gaceead3e4aaba543b7fc1d194fcbc40f8">apop_estimate_coefficient_of_determination</a> to add <img class="formulaInl" alt="$R^2$" src="form_43.png"/>-type information (SSE, SSR, &amp;c) to the info page.</p>
<p>Residuals: I add a page named <code>&lt;Predicted&gt;</code>, with three columns. If this is a model with a single dependent and lots of independent vars, then the first column is the actual data. Let our model be <img class="formulaInl" alt="$ Y = \beta X + \epsilon$" src="form_152.png"/>. Then the second column is the predicted values: <img class="formulaInl" alt="$\beta X$" src="form_153.png"/>, and the third column is the residuals: <img class="formulaInl" alt="$\epsilon$" src="form_45.png"/>. The third column is therefore always the first minus the second, and this is probably how that column was calculated internally.</p>
<p class="endtd">Given your estimate <code>est</code>, the zeroth element is one of <br/>
 <code> apop_data_get(est-&gt;info, .page= "Predicted", .row=0, .colname="observed"),</code><br/>
 <code> apop_data_get(est-&gt;info, .page= "Predicted", .row=0, .colname="predicted") or</code><br/>
 <code> apop_data_get(est-&gt;info, .page= "Predicted", .row=0, .colname="residual").</code><br/>
  </p>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga85524b1deabd5829227888fd91740cc3a55b3f592cfb119a98e9271136d8f0472"></a><!-- doxytag: member="RNG" ref="gga85524b1deabd5829227888fd91740cc3a55b3f592cfb119a98e9271136d8f0472" args="" -->RNG</em>&nbsp;</td><td>
<p>Linear models are typically only partially defined probability models. For OLS, we know that <img class="formulaInl" alt="$P(Y|X\beta) \sim {\cal N}(X\beta, \sigma)$" src="form_154.png"/>, because this is an assumption about the error process, but we don't know much of anything about the distribution of <img class="formulaInl" alt="$X$" src="form_106.png"/>.</p>
<p>The <a class="el" href="structapop__lm__settings.html">apop_lm_settings</a> group includes an <a class="el" href="structapop__model.html">apop_model</a>* element named <code>input_distribution</code>. This is the distribution of the independent/predictor/X columns of the data set.</p>
<p>The default is that <code>input_distribution = apop_improper_uniform </code>, meaning that <img class="formulaInl" alt="$P(X)=1$" src="form_155.png"/> for all <img class="formulaInl" alt="$X$" src="form_106.png"/>. So <img class="formulaInl" alt="$P(Y, X) = P(Y|X)P(X) = P(Y|X)$" src="form_156.png"/>. This seems to be how many people use linear models: the <img class="formulaInl" alt="$X$" src="form_106.png"/> values are taken as certain (as with actually observed data) and the only question is the odds of the dependent variable. If that's what you're looking for, just leave the default. This is sufficient for getting log likelihoods under the typical assumption that the observed data has probability one.</p>
<p><em>But</em> you can't draw from an improper uniform. So if you draw from a linear model with a default <code>input_distribution</code>, then you'll get an error.</p>
<p>Alternatively, you may know something about the distribution of the input data. At the least, you could generate a PMF from the actual data: </p>
<div class="fragment"><pre class="fragment">    apop_settings_set(your_model, apop_lm, input_distribution, <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(inset, <a class="code" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a>));
</pre></div><p> Now, random draws are taken from the input data, and the dependent variable value calculated via <img class="formulaInl" alt="$X\beta+\epsilon$" src="form_157.png"/>, where <img class="formulaInl" alt="$X$" src="form_106.png"/> is the drawn value, <img class="formulaInl" alt="$\beta$" src="form_2.png"/> the previously-estimated parameters and <img class="formulaInl" alt="$\epsilon$" src="form_45.png"/> is a Normally-distributed random draw. Or change the PMF to any other appropriate distribution, such as a <a class="el" href="group__models.html#ga3a4389e6e2a1a2ea606f89d55ec558d3">apop_multivariate_normal</a>, or an <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a> filled in with more data, or perhaps something from <a href="http://en.wikipedia.org/wiki/Errors-in-variables_models">http://en.wikipedia.org/wiki/Errors-in-variables_models</a> , as desired. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga85524b1deabd5829227888fd91740cc3adfe6bde7217c7ef7608fb1de6790ca8e"></a><!-- doxytag: member="Examples" ref="gga85524b1deabd5829227888fd91740cc3adfe6bde7217c7ef7608fb1de6790ca8e" args="" -->Examples</em>&nbsp;</td><td>
<p>First, you will need a file named <code>data</code> in comma-separated form. The first column is the dependent variable; the remaining columns are the independent. For example: </p>
<div class="fragment"><pre class="fragment">Y, X_1, X_2, X_3
2,3,4,5
1,2,9,3
4,7,9,0
2,4,8,16
1,4,2,9
9,8,7,6
</pre></div><p>The program: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;apop.h&gt;</span>

<span class="keywordtype">int</span> main(<span class="keywordtype">void</span>){
    <a class="code" href="group__conversions.html#gaa57d56a9a364a4f2955d27741bbbf137">apop_text_to_db</a>(.text_file=<span class="stringliteral">&quot;data&quot;</span>, .tabname=<span class="stringliteral">&quot;d&quot;</span>);
    <a class="code" href="structapop__data.html">apop_data</a> *data = <a class="code" href="group__queries.html#gade862993166c6482f53562fb77721db9">apop_query_to_data</a>(<span class="stringliteral">&quot;select * from d&quot;</span>);
    <a class="code" href="structapop__model.html">apop_model</a> *est = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(data, <a class="code" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a>);
    apop_model_show(est);
}
</pre></div><p>If you saved this code to <code>sample.c</code>, then you can compile it with </p>
<div class="fragment"><pre class="fragment">gcc sample.c -std=gnu99 -lapophenia -lgsl -lgslcblas -lsqlite3 -o run_me
</pre></div><p>and then run it with <code>./run_me</code>. Alternatively, you may prefer to compile the program using a <a class="el" href="makefile.html">Makefile</a> .</p>
<p>Feeling lazy? The program above was good form and demonstrated useful features, but the code below will do the same thing in two lines:</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;apop.h&gt;</span>
<span class="keywordtype">int</span> main(){ apop_model_show(<a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(<a class="code" href="group__conversions.html#ga630de5d4fcbe9ef13373029f5d813a97">apop_text_to_data</a>(<span class="stringliteral">&quot;data&quot;</span>), <a class="code" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a>)); }
</pre></div> </td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaca8f3323c57e0223a9f3c0f991c9760e"></a><!-- doxytag: member="model_doc.h::apop_pmf" ref="gaca8f3323c57e0223a9f3c0f991c9760e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A probability mass function is commonly known as a histogram, or still more commonly, a bar chart. It indicates that at a given coordinate, there is a given mass.</p>
<p>The data format for the PMF is simple: each row holds the coordinates, and the <em>weights vector</em> holds the mass at the given point. This is in contrast to the crosstab format, where the location is simply given by the position of the data point in the grid.</p>
<p>For example, here is a typical crosstab:</p>
<table class="doxtable">
<tr>
<td></td><td>col 0</td><td>col 1</td><td>col 2 </td></tr>
<tr>
<td>row 0 </td><td>0</td><td>8.1</td><td>3.2 </td></tr>
<tr>
<td>row 1 </td><td>0</td><td>0</td><td>2.2 </td></tr>
<tr>
<td>row 2 </td><td>0</td><td>7.3</td><td>1.2 </td></tr>
</table>
<p>Here it is as a sparse listing:</p>
<table class="doxtable">
<tr>
<td>value dimension 1</td><td>dimension 2</td><td></td></tr>
<tr>
<td>8.1 </td><td>0 </td><td>1  </td></tr>
<tr>
<td>3.2 </td><td>0 </td><td>2  </td></tr>
<tr>
<td>2.2 </td><td>1 </td><td>2  </td></tr>
<tr>
<td>7.3 </td><td>2 </td><td>1  </td></tr>
<tr>
<td>1.2 </td><td>2 </td><td>2  </td></tr>
</table>
<p>The <code>apop_pmf</code> internally represents data in this manner. The dimensions are held in the <code>matrix</code> element of the data set, and the cell values are held in the <code>weights</code> element (<em>not the vector</em>).</p>
<p>If your data is in a crosstab (with entries in the matrix element for 2-D data or the vector for 1-D data), then use apop_crosstab_to_pmf to make the conversion.</p>
<p>If your data is already in the sparse listing format (which is probably the case for 3- or more dimensional data), then just point the model to your parameter set:</p>
<div class="fragment"><pre class="fragment"><a class="code" href="structapop__model.html">apop_model</a> *my_pmf = <a class="code" href="group__models.html#ga14f2bd54421fd6629baccb8a41ecd304">apop_model_copy</a>(<a class="code" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a>);
my_pmf-&gt;<a class="code" href="structapop__model.html#a076635fcdacf54e685c4715c07c1183c">data</a> = in_data;
<span class="comment">//or equivalently:</span>
<a class="code" href="structapop__model.html">apop_model</a> *my_pmf = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(in_data, <a class="code" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a>);
</pre></div><ul>
<li>If the <code>weights</code> element is <code>NULL</code>, then I assume that all rows of the data set are equally probable. </li>
<li>If the <code>weights</code> are present but sum to a not-finite value, the model's <code>error</code> element is set to <code>'w'</code> when the estimation is run, and a warning printed.</li>
</ul>
<ul>
<li>Be careful: the weights are in the <code>weights</code> element of the <code><a class="el" href="structapop__data.html">apop_data</a></code> set, not in the <code>vector</code> element. If you put the weights in the <code>vector</code> and have <code>NULL</code> <code>weights</code>, then draws are equiprobable. This will be difficult to debug. </li>
</ul>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaca8f3323c57e0223a9f3c0f991c9760ea47a9e46902e09fba9b17319507c11c98"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaca8f3323c57e0223a9f3c0f991c9760ea47a9e46902e09fba9b17319507c11c98" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Prob. </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Log likelihood </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Prep routine </td><td class="altcolor">M  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaca8f3323c57e0223a9f3c0f991c9760eaffd081bcb4368f169538c14bebd4020c"></a><!-- doxytag: member="Name" ref="ggaca8f3323c57e0223a9f3c0f991c9760eaffd081bcb4368f169538c14bebd4020c" args="" -->Name</em>&nbsp;</td><td>
<p><code>PDF or sparse matrix</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaca8f3323c57e0223a9f3c0f991c9760ea2e767a027546109b44c899bab669101c"></a><!-- doxytag: member="Input format" ref="ggaca8f3323c57e0223a9f3c0f991c9760ea2e767a027546109b44c899bab669101c" args="" -->Input format</em>&nbsp;</td><td>
<p>As above, you can input to the <code>estimate</code> routine a 2-D matrix that will be converted into this form. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaca8f3323c57e0223a9f3c0f991c9760eadcb38d478c57f0423f91f0f87a1ea029"></a><!-- doxytag: member="Parameter format" ref="ggaca8f3323c57e0223a9f3c0f991c9760eadcb38d478c57f0423f91f0f87a1ea029" args="" -->Parameter format</em>&nbsp;</td><td>
<p>None. The list of observations and their weights are in the <code>data</code> set, not the <code>parameters</code>. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaca8f3323c57e0223a9f3c0f991c9760ea6054b43b99e4a02f9b7665ede0cb2d67"></a><!-- doxytag: member="Post-estimate" ref="ggaca8f3323c57e0223a9f3c0f991c9760ea6054b43b99e4a02f9b7665ede0cb2d67" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">The data you sent in is linked to (not copied).  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">Still <code>NULL</code>.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaca8f3323c57e0223a9f3c0f991c9760ea38c95407fb642dcd3af88742320657b2"></a><!-- doxytag: member="RNG" ref="ggaca8f3323c57e0223a9f3c0f991c9760ea38c95407fb642dcd3af88742320657b2" args="" -->RNG</em>&nbsp;</td><td>
<p>Return the data in a random row of the PMF's data set. If there is a weights vector, i will use that to make draws; else all rows are equiprobable.</p>
<ul>
<li>If you set <code>draw_index</code> to <code>'y'</code>, e.g.,</li>
</ul>
<div class="fragment"><pre class="fragment">Apop_settings_add(your_model, <a class="code" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a>, draw_index, <span class="charliteral">&#39;y&#39;</span>);
</pre></div><p>then I will return the row number of the draw, not the data in that row.</p>
<ul>
<li>The first time you draw from a PMF, I will generate a CMF (Cumulative Mass Function). For an especially large data set this may take a human-noticeable amount of time. The CMF will be stored in <code>parameters-&gt;weights[1]</code>, and subsequent draws will have no computational overhead.</li>
</ul>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">m-&gt;error='f'</td><td>There is zero or NaN density in the CMF. I set the model's <code>error</code> element to <code>'f'</code> and set <code>out=NAN</code>. </td></tr>
    <tr><td class="paramname">m-&gt;error='a'</td><td>Allocation error. I set the model's <code>error</code> element to <code>'a'</code> and set <code>out=NAN</code>. Maybe try <a class="el" href="asst_8h.html#acc90578a8086a2e6f7b1575300260f08">apop_data_pmf_compress</a> first? </td></tr>
  </table>
  </dd>
</dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaca8f3323c57e0223a9f3c0f991c9760eac0aad2bd7945fa65ed8962b6732e706e"></a><!-- doxytag: member="Settings" ref="ggaca8f3323c57e0223a9f3c0f991c9760eac0aad2bd7945fa65ed8962b6732e706e" args="" -->Settings</em>&nbsp;</td><td>
<p><a class="el" href="structapop__pmf__settings.html">apop_pmf_settings</a> </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga9c67838a4761452cc2c9113557f2a070"></a><!-- doxytag: member="model_doc.h::apop_poisson" ref="ga9c67838a4761452cc2c9113557f2a070" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga9c67838a4761452cc2c9113557f2a070">apop_poisson</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Poisson distribution.</p>
<p><img class="formulaInl" alt="$p(k) = {\mu^k \over k!} \exp(-\mu), $" src="form_132.png"/> </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga9c67838a4761452cc2c9113557f2a070a79a611c8bbb1879eb6d3e8b517c17be1"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga9c67838a4761452cc2c9113557f2a070a79a611c8bbb1879eb6d3e8b517c17be1" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9c67838a4761452cc2c9113557f2a070ad36eb2b479fabf747ff436cfcd058420"></a><!-- doxytag: member="Name" ref="gga9c67838a4761452cc2c9113557f2a070ad36eb2b479fabf747ff436cfcd058420" args="" -->Name</em>&nbsp;</td><td>
<p><code>Poisson distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9c67838a4761452cc2c9113557f2a070a1d9fc901db36a3b24ac475dbaff49df6"></a><!-- doxytag: member="Input format" ref="gga9c67838a4761452cc2c9113557f2a070a1d9fc901db36a3b24ac475dbaff49df6" args="" -->Input format</em>&nbsp;</td><td>
<p>Location of data in the grid is not relevant; send it a 1 x N, N x 1, or N x M and it will all be the same. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9c67838a4761452cc2c9113557f2a070a7b955663606e29306e0b201d48ccb0ee"></a><!-- doxytag: member="Parameter format" ref="gga9c67838a4761452cc2c9113557f2a070a7b955663606e29306e0b201d48ccb0ee" args="" -->Parameter format</em>&nbsp;</td><td>
<p>One parameter, the zeroth element of the vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9c67838a4761452cc2c9113557f2a070a77a7e2268a144266c3be7cbb049d5876"></a><!-- doxytag: member="Post-estimate" ref="gga9c67838a4761452cc2c9113557f2a070a77a7e2268a144266c3be7cbb049d5876" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top"><p class="starttd"></p>
<p>Unless you decline it by adding the <a class="el" href="structapop__parts__wanted__settings.html">apop_parts_wanted_settings</a> group, I will also give you the variance of the parameter, via bootstrap, stored in a page named <code>&lt;Covariance&gt;</code>.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports <code>log likelihood</code>.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9c67838a4761452cc2c9113557f2a070ad1562cca7500647c341ac3b84bda0104"></a><!-- doxytag: member="RNG" ref="gga9c67838a4761452cc2c9113557f2a070ad1562cca7500647c341ac3b84bda0104" args="" -->RNG</em>&nbsp;</td><td>
<p>Just a wrapper for <code>gsl_ran_poisson</code>. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga319b8e3d5025a6fc94829a978273eb8b"></a><!-- doxytag: member="model_doc.h::apop_probit" ref="ga319b8e3d5025a6fc94829a978273eb8b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga319b8e3d5025a6fc94829a978273eb8b">apop_probit</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Probit model.</p>
<p>Apophenia makes no distinction between the bivariate probit and the multinomial probit. This one does both. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga319b8e3d5025a6fc94829a978273eb8baa8ec35491262164a252887f0d1139bfe"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga319b8e3d5025a6fc94829a978273eb8baa8ec35491262164a252887f0d1139bfe" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">RNG </td><td class="memitem">D  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Prep routine </td><td class="altcolor">M  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319b8e3d5025a6fc94829a978273eb8ba7e9d07d117adcc3e70c97f846f03003c"></a><!-- doxytag: member="Name" ref="gga319b8e3d5025a6fc94829a978273eb8ba7e9d07d117adcc3e70c97f846f03003c" args="" -->Name</em>&nbsp;</td><td>
<p><code>Probit</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319b8e3d5025a6fc94829a978273eb8baaa15b17d2202559927e802902e9502b6"></a><!-- doxytag: member="Input format" ref="gga319b8e3d5025a6fc94829a978273eb8baaa15b17d2202559927e802902e9502b6" args="" -->Input format</em>&nbsp;</td><td>
<p>The first column of the data matrix this model expects is zeros, ones, ..., enumerating the factors; to get there, try <a class="el" href="stats_8h.html#a27405bd5fdf48d93c8918ca4c07ee260">apop_data_to_factors</a>; if you forget to run it, I'll run it on the first data column for you. The remaining columns are values of the independent variables. Thus, the model will return [(data columns)-1] <img class="formulaInl" alt="$\times$" src="form_158.png"/>[(option count)-1] parameters. Column names are options; row names are input variables. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319b8e3d5025a6fc94829a978273eb8bad06f259a28c1c368d74e83cde0eb8d85"></a><!-- doxytag: member="Prep_routine" ref="gga319b8e3d5025a6fc94829a978273eb8bad06f259a28c1c368d74e83cde0eb8d85" args="" -->Prep_routine</em>&nbsp;</td><td>
<p>You will probably want to convert some column of your data into factors, via <a class="el" href="stats_8h.html#a27405bd5fdf48d93c8918ca4c07ee260">apop_data_to_factors</a>. If you do, then that adds a page of factors to your data set (and of course adjusts the data itself). If I find a factor page, I will use that info; if not, then I will run <a class="el" href="stats_8h.html#a27405bd5fdf48d93c8918ca4c07ee260">apop_data_to_factors</a> on the first column (the vector if there is one, else the first column of the matrix.)</p>
<p>Also, if there is no vector, then I will move the first column of the matrix, and replace that matrix column with a constant column of ones, just like with OLS. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319b8e3d5025a6fc94829a978273eb8bab26fab7da0a30d6a66ab5b8bc6e54c9f"></a><!-- doxytag: member="Parameter format" ref="gga319b8e3d5025a6fc94829a978273eb8bab26fab7da0a30d6a66ab5b8bc6e54c9f" args="" -->Parameter format</em>&nbsp;</td><td>
<p>As above </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319b8e3d5025a6fc94829a978273eb8ba21e8c46a464f0d7c0cfea5506a1beaf4"></a><!-- doxytag: member="Post-estimate" ref="gga319b8e3d5025a6fc94829a978273eb8ba21e8c46a464f0d7c0cfea5506a1beaf4" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga319b8e3d5025a6fc94829a978273eb8ba3a3cffad0b7ca17d9fd78dcc68052a5b"></a><!-- doxytag: member="RNG" ref="gga319b8e3d5025a6fc94829a978273eb8ba3a3cffad0b7ca17d9fd78dcc68052a5b" args="" -->RNG</em>&nbsp;</td><td>
<p>See <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a>; this one is similar but produces a category number instead of OLS's continuous draw. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaf4fa26b04f324b9895b7599e323203df"></a><!-- doxytag: member="model_doc.h::apop_stack" ref="gaf4fa26b04f324b9895b7599e323203df" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaf4fa26b04f324b9895b7599e323203df">apop_stack</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A stack of models.</p>
<p>For the case when you need to bundle two uncorrelated models into one larger model. For example, the prior for a multivariate normal (whose parameters are a vector of means and a covariance matrix) is a Multivariate Normal-Wishart pair. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaf4fa26b04f324b9895b7599e323203dfa2a66d7661b1469f4f790a7cecd41e758"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaf4fa26b04f324b9895b7599e323203dfa2a66d7661b1469f4f790a7cecd41e758" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Prob. </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf4fa26b04f324b9895b7599e323203dfab50a9cab69449ac7f463fb901ed4d9f5"></a><!-- doxytag: member="Name" ref="ggaf4fa26b04f324b9895b7599e323203dfab50a9cab69449ac7f463fb901ed4d9f5" args="" -->Name</em>&nbsp;</td><td>
<p><code>Stack of models</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf4fa26b04f324b9895b7599e323203dfa34d07ea4c98e604347548d1df317a876"></a><!-- doxytag: member="Input format" ref="ggaf4fa26b04f324b9895b7599e323203dfa34d07ea4c98e604347548d1df317a876" args="" -->Input format</em>&nbsp;</td><td>
<p>There are two means of handling the input format. If the settings group attached to the data set has a non-<code>NULL</code> <code>splitpage</code> element, then Append the second data set as an additional page to the first data set, and name the second set with the name you listed in <code>splitpage</code>; see the example.</p>
<p>If <code>splitpage</code> is <code>NULL</code>, then I will send the same data set to both models. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf4fa26b04f324b9895b7599e323203dfa30dbfb278b2779b1961a172b1c40fd04"></a><!-- doxytag: member="Parameter format" ref="ggaf4fa26b04f324b9895b7599e323203dfa30dbfb278b2779b1961a172b1c40fd04" args="" -->Parameter format</em>&nbsp;</td><td>
<p>currently <code>NULL</code>; check the sub-models for their parameters. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf4fa26b04f324b9895b7599e323203dfaf4a6f63148777b24fc53fda3b319be1b"></a><!-- doxytag: member="Post-estimate" ref="ggaf4fa26b04f324b9895b7599e323203dfaf4a6f63148777b24fc53fda3b319be1b" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaf4fa26b04f324b9895b7599e323203dfa19467036bb2d07e21c32dc9d80490621"></a><!-- doxytag: member="Settings" ref="ggaf4fa26b04f324b9895b7599e323203dfa19467036bb2d07e21c32dc9d80490621" args="" -->Settings</em>&nbsp;</td><td>
<p><a class="el" href="structapop__stack__settings.html">apop_stack_settings</a> </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga45ce986bd5ea79c39877792bec39a304"></a><!-- doxytag: member="model_doc.h::apop_t_distribution" ref="ga45ce986bd5ea79c39877792bec39a304" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga45ce986bd5ea79c39877792bec39a304">apop_t_distribution</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The t distribution, primarily for descriptive purposes.</p>
<p>If you want to test a hypothesis, you probably don't need this, and should instead use <a class="el" href="asst_8h.html#a650d1ecf6f78c3bdb85c8fce71dfae05">apop_test</a>. See notes in <a class="el" href="group__tfchi.html">t-, chi-squared, F-, Wishart distributions</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga45ce986bd5ea79c39877792bec39a304a10ab961e00a8a4104cb02b1a9ac039a7"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga45ce986bd5ea79c39877792bec39a304a10ab961e00a8a4104cb02b1a9ac039a7" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga45ce986bd5ea79c39877792bec39a304a8340de4a3c0c8d18b863dfa74bd6a840"></a><!-- doxytag: member="Name" ref="gga45ce986bd5ea79c39877792bec39a304a8340de4a3c0c8d18b863dfa74bd6a840" args="" -->Name</em>&nbsp;</td><td>
<p><code>t distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga45ce986bd5ea79c39877792bec39a304a4d4c552d34250864aee09c19751ef626"></a><!-- doxytag: member="Input format" ref="gga45ce986bd5ea79c39877792bec39a304a4d4c552d34250864aee09c19751ef626" args="" -->Input format</em>&nbsp;</td><td>
<p>Unordered list of scalars in the matrix and/or vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga45ce986bd5ea79c39877792bec39a304a2f3f79a4405bb7bd324ff24d16da91fd"></a><!-- doxytag: member="Parameter format" ref="gga45ce986bd5ea79c39877792bec39a304a2f3f79a4405bb7bd324ff24d16da91fd" args="" -->Parameter format</em>&nbsp;</td><td>
<p>vector-&gt;data[0] = mu<br/>
 vector-&gt;data[1] = sigma<br/>
 vector-&gt;data[2] = df </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga45ce986bd5ea79c39877792bec39a304acc7686fb2b6e9a092552e86be416b414"></a><!-- doxytag: member="Post-estimate" ref="gga45ce986bd5ea79c39877792bec39a304acc7686fb2b6e9a092552e86be416b414" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga95be4cc3931072118a7c8ffece73fbe1"></a><!-- doxytag: member="model_doc.h::apop_uniform" ref="ga95be4cc3931072118a7c8ffece73fbe1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga95be4cc3931072118a7c8ffece73fbe1">apop_uniform</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is the two-parameter version of the Uniform, expressing a uniform distribution over [a, b].</p>
<p>The MLE of this distribution is simply a = min(your data); b = max(your data). Primarily useful for the RNG, such as when you have a Uniform prior model. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga95be4cc3931072118a7c8ffece73fbe1a71b80077c70e74db2a5fb01cf6a3a6b3"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga95be4cc3931072118a7c8ffece73fbe1a71b80077c70e74db2a5fb01cf6a3a6b3" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Prob. </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">CDF </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga95be4cc3931072118a7c8ffece73fbe1a7a36b9c3f94d21e01cee5cf096d907e8"></a><!-- doxytag: member="Name" ref="gga95be4cc3931072118a7c8ffece73fbe1a7a36b9c3f94d21e01cee5cf096d907e8" args="" -->Name</em>&nbsp;</td><td>
<p><code>Uniform distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga95be4cc3931072118a7c8ffece73fbe1a1447a7e2de7876a649185166e0e3471e"></a><!-- doxytag: member="Input format" ref="gga95be4cc3931072118a7c8ffece73fbe1a1447a7e2de7876a649185166e0e3471e" args="" -->Input format</em>&nbsp;</td><td>
<p>An unordered set of numbers in the data set's vector, matrix, or both. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga95be4cc3931072118a7c8ffece73fbe1addf9c786868d2562b43e0de520c08093"></a><!-- doxytag: member="Parameter format" ref="gga95be4cc3931072118a7c8ffece73fbe1addf9c786868d2562b43e0de520c08093" args="" -->Parameter format</em>&nbsp;</td><td>
<p>Zeroth vector element is <img class="formulaInl" alt="$a$" src="form_161.png"/>, the min; element one is <img class="formulaInl" alt="$b$" src="form_162.png"/>, the max. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga95be4cc3931072118a7c8ffece73fbe1a13782bd575616ed1ecc86a728a537e73"></a><!-- doxytag: member="Post-estimate" ref="gga95be4cc3931072118a7c8ffece73fbe1a13782bd575616ed1ecc86a728a537e73" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
<tr>
<td style="vertical-align:top"><code>info</code></td><td style="vertical-align:top">Reports <code>log likelihood</code>.  </td></tr>
</table>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaa7b3f288233f063dffda45743fd61c72"></a><!-- doxytag: member="model_doc.h::apop_waring" ref="gaa7b3f288233f063dffda45743fd61c72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaa7b3f288233f063dffda45743fd61c72">apop_waring</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Waring distribution</p>
<p><img class="formulaInl" alt="$W(x,k, b,a) = (b-1) \gamma(b+a) \gamma(k+a) / [\gamma(a+1) \gamma(k+a+b)]$" src="form_117.png"/></p>
<p><img class="formulaInl" alt="$\ln W(x, b, a) = \ln(b-1) + \ln\gamma(b+a) + \ln\gamma(k+a) - \ln\gamma(a+1) - \ln\gamma(k+a+b)$" src="form_118.png"/></p>
<p><img class="formulaInl" alt="$dlnW/db = 1/(b-1) + \psi(b+a) - \psi(k+a+b)$" src="form_119.png"/></p>
<p><img class="formulaInl" alt="$dlnW/da = \psi(b+a) + \psi(k+a) - \psi(a+1) - \psi(k+a+b)$" src="form_120.png"/> </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaa7b3f288233f063dffda45743fd61c72a4bfc502b66314347b040a9a4a00a30d8"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaa7b3f288233f063dffda45743fd61c72a4bfc502b66314347b040a9a4a00a30d8" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa7b3f288233f063dffda45743fd61c72a9b0ac23dff498a53a6000fdec0db5416"></a><!-- doxytag: member="Name" ref="ggaa7b3f288233f063dffda45743fd61c72a9b0ac23dff498a53a6000fdec0db5416" args="" -->Name</em>&nbsp;</td><td>
<p><code>Waring distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa7b3f288233f063dffda45743fd61c72a94c8339423d3b2beb26ff316f9da2fa2"></a><!-- doxytag: member="Input format" ref="ggaa7b3f288233f063dffda45743fd61c72a94c8339423d3b2beb26ff316f9da2fa2" args="" -->Input format</em>&nbsp;</td><td>
<p>Ignores the matrix structure of the input data, so send in a 1 x N, an N x 1, or an N x M.</p>
<p>See also <a class="el" href="types_8h.html#a8c4bb25171301f09a35c36306a7b9783">apop_data_rank_compress</a> for means of dealing with one more input data format. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa7b3f288233f063dffda45743fd61c72a66b0b4b64c2b1e8d705fa9e6aaaeb272"></a><!-- doxytag: member="Parameter format" ref="ggaa7b3f288233f063dffda45743fd61c72a66b0b4b64c2b1e8d705fa9e6aaaeb272" args="" -->Parameter format</em>&nbsp;</td><td>
<p>Two elements in the parameter set's vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa7b3f288233f063dffda45743fd61c72acfb34ccd0a1fb354d89a73f71cffa7c4"></a><!-- doxytag: member="Post-estimate" ref="ggaa7b3f288233f063dffda45743fd61c72acfb34ccd0a1fb354d89a73f71cffa7c4" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa7b3f288233f063dffda45743fd61c72ae11d6e921286847c288108ac6a69f4fb"></a><!-- doxytag: member="RNG" ref="ggaa7b3f288233f063dffda45743fd61c72ae11d6e921286847c288108ac6a69f4fb" args="" -->RNG</em>&nbsp;</td><td>
<p>Give me parameters, and I'll draw a ranking from the appropriate Waring distribution. [I.e., if I randomly draw from a Waring-distributed population, return the ranking of the item I just drew.]</p>
<p>Source: page seven of L. Devroye, <a href="http://cgm.cs.mcgill.ca/~luc/digammapaper.ps">Random variate generation for the digamma and trigamma distributions</a>, Journal of Statistical Computation and Simulation, vol. 43, pp. 197-216, 1992. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga79148851aa36fdad05fdb197778a583e"></a><!-- doxytag: member="model_doc.h::apop_wishart" ref="ga79148851aa36fdad05fdb197778a583e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga79148851aa36fdad05fdb197778a583e">apop_wishart</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Wishart distribution, which is currently somewhat untested.</p>
<p>Here's the likelihood function. <img class="formulaInl" alt="$p$" src="form_19.png"/> is the dimension of the data and covariance matrix, <img class="formulaInl" alt="$n$" src="form_9.png"/> is the degrees of freedom, <img class="formulaInl" alt="$\mathbf{V}$" src="form_121.png"/> is the <img class="formulaInl" alt="$p\times p$" src="form_122.png"/> matrix of Wishart parameters, and <img class="formulaInl" alt="${\mathbf{W}}$" src="form_123.png"/> is the <img class="formulaInl" alt="$p\times p$" src="form_122.png"/> matrix whose likelihood is being evaluated. <img class="formulaInl" alt="$\Gamma_p(\cdot)$" src="form_124.png"/> is the <a class="el" href="stats_8h.html#a463920325a6102396515d80e57e6c519">multivariate gamma function</a>.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ P(\mathbf{W}) = \frac{\left|\mathbf{W}\right|^\frac{n-p-1}{2}} {2^\frac{np}{2}\left|{\mathbf V}\right|^\frac{n}{2}\Gamma_p(\frac{n}{2})} \exp\left(-\frac{1}{2}{\rm Tr}({\mathbf V}^{-1}\mathbf{W})\right)\]" src="form_125.png"/>
</p>
<p>See also notes in <a class="el" href="group__tfchi.html">t-, chi-squared, F-, Wishart distributions</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga79148851aa36fdad05fdb197778a583eac9d90eb7008530b982b1304dd7f4df28"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga79148851aa36fdad05fdb197778a583eac9d90eb7008530b982b1304dd7f4df28" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="altcolor">Estimation </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Prep routine </td><td class="altcolor">M  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga79148851aa36fdad05fdb197778a583ea768face88a8da38940f85fd8f2b358b7"></a><!-- doxytag: member="Name" ref="gga79148851aa36fdad05fdb197778a583ea768face88a8da38940f85fd8f2b358b7" args="" -->Name</em>&nbsp;</td><td>
<p><code>Wishart distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga79148851aa36fdad05fdb197778a583ea7726ba92ff736932c6c1d46b94ac4d24"></a><!-- doxytag: member="Input format" ref="gga79148851aa36fdad05fdb197778a583ea7726ba92ff736932c6c1d46b94ac4d24" args="" -->Input format</em>&nbsp;</td><td>
<p>Each row of the input matrix is a single square matrix, flattened; use <a class="el" href="group__conversions.html#ga7e31798ab418cbfc7488eaba27dad2af">apop_data_pack</a> to convert your sequence of matrices into rows. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga79148851aa36fdad05fdb197778a583ea601dbec8df12679c3916650c3697694f"></a><!-- doxytag: member="Prep_routine" ref="gga79148851aa36fdad05fdb197778a583ea601dbec8df12679c3916650c3697694f" args="" -->Prep_routine</em>&nbsp;</td><td>
<p>Just allocates the parameters based on the size of the input data. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga79148851aa36fdad05fdb197778a583eaa6bd610f2d8f49e31e356ba35f7e36ad"></a><!-- doxytag: member="Parameter format" ref="gga79148851aa36fdad05fdb197778a583eaa6bd610f2d8f49e31e356ba35f7e36ad" args="" -->Parameter format</em>&nbsp;</td><td>
<p><img class="formulaInl" alt="$N$" src="form_3.png"/> (the degrees of freedom) is the zeroth element of the vector. The matrix holds the matrix of parameters. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga79148851aa36fdad05fdb197778a583eae7c7f112f3a528b7b74bc5d814985a6b"></a><!-- doxytag: member="Post-estimate" ref="gga79148851aa36fdad05fdb197778a583eae7c7f112f3a528b7b74bc5d814985a6b" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga79148851aa36fdad05fdb197778a583ea6c65270f204ee95d6da7276c1f6d8380"></a><!-- doxytag: member="RNG" ref="gga79148851aa36fdad05fdb197778a583ea6c65270f204ee95d6da7276c1f6d8380" args="" -->RNG</em>&nbsp;</td><td>
<p>You can use this to generate random covariance matrices, should you need them. See example below. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga79148851aa36fdad05fdb197778a583eaeadbb4cee1cc703362f856e1ab22666e"></a><!-- doxytag: member="Examples" ref="gga79148851aa36fdad05fdb197778a583eaeadbb4cee1cc703362f856e1ab22666e" args="" -->Examples</em>&nbsp;</td><td>
<p>Making some random draws:</p>
<div class="fragment"><pre class="fragment"><a class="code" href="structapop__model.html">apop_model</a> *m = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(yr_data, <a class="code" href="group__models.html#ga79148851aa36fdad05fdb197778a583e">apop_wishart</a>);
gsl_matrix *rmatrix = gsl_matrix_alloc(10, 10);
gsl_rng *r = <a class="code" href="group__convenience__fns.html#gada044cf02135422a9f9292b6054c86dd">apop_rng_alloc</a>(8765);
<span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; 1e8; i++){
    <a class="code" href="group__models.html#gaca737ed521192a76a307bbf825ab4a97">apop_draw</a>(rmatrix-&gt;data, r, m);
    do_math_with_matrix(rmatrix);
}
</pre></div> </td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="gaa030af2c41ac564c3a9ccce14b06f13c"></a><!-- doxytag: member="model_doc.h::apop_wls" ref="gaa030af2c41ac564c3a9ccce14b06f13c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#gaa030af2c41ac564c3a9ccce14b06f13c">apop_wls</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Weighed Least Squares model This is a (deprecated) synonym for <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a>, qv. If you use the <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a> model and provide weights in <code>your_input_data-&gt;weights</code>, then I will use them appropriately. That is, the <a class="el" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a> model really implements Weighted Least Squares, but in most cases <code>weights==NULL</code> and the math reduces to the special case of Ordinary Least Squares. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ggaa030af2c41ac564c3a9ccce14b06f13ca4576471c8d56b15d7daafd21b46dd9af"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="ggaa030af2c41ac564c3a9ccce14b06f13ca4576471c8d56b15d7daafd21b46dd9af" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Log likelihood </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">RNG </td><td class="memitem">D  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ggaa030af2c41ac564c3a9ccce14b06f13cab5e4f4463942bb3a1ef2cad2ac77e105"></a><!-- doxytag: member="Post-estimate" ref="ggaa030af2c41ac564c3a9ccce14b06f13cab5e4f4463942bb3a1ef2cad2ac77e105" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1ddf478052543e1d801dfc64c99bcbe3"></a><!-- doxytag: member="model_doc.h::apop_yule" ref="ga1ddf478052543e1d801dfc64c99bcbe3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga1ddf478052543e1d801dfc64c99bcbe3">apop_yule</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><img class="formulaInl" alt="$ Y(x, b) = (b-1) \gamma(b) \gamma(k) / \gamma(k+b) $" src="form_114.png"/></p>
<p><img class="formulaInl" alt="$ \ln Y(x, b) = \ln(b-1) + ln\gamma(b) + \ln\gamma(k) - \ln\gamma(k+b) $" src="form_115.png"/></p>
<p><img class="formulaInl" alt="$ d\ln Y/db = 1/(b-1) + \psi(b) - \psi(k+b) $" src="form_116.png"/></p>
<p>apop_yule.estimate() is an MLE, so feed it appropriate <a class="el" href="structapop__mle__settings.html">apop_mle_settings</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga1ddf478052543e1d801dfc64c99bcbe3a8dfa35c139898bf7a2815bc05c2edf55"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga1ddf478052543e1d801dfc64c99bcbe3a8dfa35c139898bf7a2815bc05c2edf55" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Score </td><td class="altcolor">M  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1ddf478052543e1d801dfc64c99bcbe3a7061bf9131a530c7172730e68935e25f"></a><!-- doxytag: member="Name" ref="gga1ddf478052543e1d801dfc64c99bcbe3a7061bf9131a530c7172730e68935e25f" args="" -->Name</em>&nbsp;</td><td>
<p><code>Yule distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1ddf478052543e1d801dfc64c99bcbe3affcf0cd4d89c436e0f50880d375eed0a"></a><!-- doxytag: member="Input format" ref="gga1ddf478052543e1d801dfc64c99bcbe3affcf0cd4d89c436e0f50880d375eed0a" args="" -->Input format</em>&nbsp;</td><td>
<p>Ignores the matrix structure of the input data, so send in a 1 x N, an N x 1, or an N x M.</p>
<p>See also <a class="el" href="types_8h.html#a8c4bb25171301f09a35c36306a7b9783">apop_data_rank_compress</a> for means of dealing with one more input data format. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1ddf478052543e1d801dfc64c99bcbe3a9eaf19a93e79a6d361ee799dee2d0ffc"></a><!-- doxytag: member="Parameter format" ref="gga1ddf478052543e1d801dfc64c99bcbe3a9eaf19a93e79a6d361ee799dee2d0ffc" args="" -->Parameter format</em>&nbsp;</td><td>
<p>One element at the top of the parameter set's vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1ddf478052543e1d801dfc64c99bcbe3a51d8850a39b747328988f2be04473066"></a><!-- doxytag: member="Post-estimate" ref="gga1ddf478052543e1d801dfc64c99bcbe3a51d8850a39b747328988f2be04473066" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga1ddf478052543e1d801dfc64c99bcbe3ab26b27aa4c0e0d09f095862485b7fe84"></a><!-- doxytag: member="RNG" ref="gga1ddf478052543e1d801dfc64c99bcbe3ab26b27aa4c0e0d09f095862485b7fe84" args="" -->RNG</em>&nbsp;</td><td>
<p>Cribbed from &lt;a href="<a href="http://cgm.cs.mcgill.ca/~luc/mbookindex.html">http://cgm.cs.mcgill.ca/~luc/mbookindex.html</a>&gt;Devroye (1986), p 553. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga32e7ca1164025cbb53a9e0ecee9d4cea"></a><!-- doxytag: member="model_doc.h::apop_zipf" ref="ga32e7ca1164025cbb53a9e0ecee9d4cea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">apop_model <a class="el" href="group__models.html#ga32e7ca1164025cbb53a9e0ecee9d4cea">apop_zipf</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Wikipedia has notes on the <a href="http://en.wikipedia.org/wiki/Zipf_distribution">Zipf distribution</a>. <img class="formulaInl" alt="$Z(a) = {1\over \zeta(a) * i^a} $" src="form_111.png"/></p>
<p><img class="formulaInl" alt="$lnZ(a) = -(\log(\zeta(a)) + a \log(i)) $" src="form_112.png"/></p>
<p>apop_zipf.estimate() is an MLE, so feed it appropriate <a class="el" href="structapop__mle__settings.html">apop_mle_settings</a>. </p>
<dl><dt></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga32e7ca1164025cbb53a9e0ecee9d4ceaa10c9a98e2c5b3b0d260a9894f6374efa"></a><!-- doxytag: member="Methods are Default or Model-specific" ref="gga32e7ca1164025cbb53a9e0ecee9d4ceaa10c9a98e2c5b3b0d260a9894f6374efa" args="" -->Methods are Default or Model-specific</em>&nbsp;</td><td>
<table  cellpadding="3px">
<tr>
<td><table  class="memproto">
<tr>
<td class="memitem">Estimation </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prob. </td><td class="memitem">D  </td></tr>
<tr>
<td class="altcolor">Log likelihood </td><td class="altcolor">M  </td></tr>
<tr>
<td class="altcolor">RNG </td><td class="altcolor">M  </td></tr>
</table>
</td><td><table  class="memproto">
<tr>
<td class="memitem">Predict </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">CDF </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Score </td><td class="memitem">D  </td></tr>
<tr>
<td class="memitem">Prep routine </td><td class="memitem">D  </td></tr>
</table>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32e7ca1164025cbb53a9e0ecee9d4ceaaa20596eaa88a1c941070aabf83449aa7"></a><!-- doxytag: member="Name" ref="gga32e7ca1164025cbb53a9e0ecee9d4ceaaa20596eaa88a1c941070aabf83449aa7" args="" -->Name</em>&nbsp;</td><td>
<p><code>Zipf distribution</code> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32e7ca1164025cbb53a9e0ecee9d4ceaa2c9a8f4c80ae456155c63f1da906d791"></a><!-- doxytag: member="Input format" ref="gga32e7ca1164025cbb53a9e0ecee9d4ceaa2c9a8f4c80ae456155c63f1da906d791" args="" -->Input format</em>&nbsp;</td><td>
<p>Ignores the matrix structure of the input data, so send in a 1 x N, an N x 1, or an N x M.</p>
<p>See also <a class="el" href="types_8h.html#a8c4bb25171301f09a35c36306a7b9783">apop_data_rank_compress</a> for means of dealing with one more input data format. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32e7ca1164025cbb53a9e0ecee9d4ceaadffbeff57f56fe192c51f4222e16f9a7"></a><!-- doxytag: member="Parameter format" ref="gga32e7ca1164025cbb53a9e0ecee9d4ceaadffbeff57f56fe192c51f4222e16f9a7" args="" -->Parameter format</em>&nbsp;</td><td>
<p>One item in the parameter set's vector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32e7ca1164025cbb53a9e0ecee9d4ceaab076d5388cfba57c54adb4a248e75e5a"></a><!-- doxytag: member="Post-estimate" ref="gga32e7ca1164025cbb53a9e0ecee9d4ceaab076d5388cfba57c54adb4a248e75e5a" args="" -->Post-estimate</em>&nbsp;</td><td>
<table class="doxtable">
<tr>
<td style="vertical-align:top"><code>data</code></td><td style="vertical-align:top">Unchanged.  </td></tr>
<tr>
<td style="vertical-align:top"><code>parameters</code></td><td style="vertical-align:top">See parameter format.  </td></tr>
</table>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32e7ca1164025cbb53a9e0ecee9d4ceaa07f9e589c3fe6025b7238fb633c191c1"></a><!-- doxytag: member="RNG" ref="gga32e7ca1164025cbb53a9e0ecee9d4ceaa07f9e589c3fe6025b7238fb633c191c1" args="" -->RNG</em>&nbsp;</td><td>
<p>Returns a ranking: If the population were Zipf distributed, you're most likely to get the 1st most common item, so this produces a lot of ones, a great deal of twos, and so on.</p>
<ul>
<li>In the interest of avoiding overflows, the RNG is capped at 1e8.</li>
</ul>
<p>Cribbed from &lt;a href="<a href="http://cgm.cs.mcgill.ca/~luc/mbookindex.html">http://cgm.cs.mcgill.ca/~luc/mbookindex.html</a>&gt;Devroye (1986), Chapter 10, p 551. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gaee16258d3e52671e254f3ce03bca7754"></a><!-- doxytag: member="apop_model.c::apop_cdf" ref="gaee16258d3e52671e254f3ce03bca7754" args="(apop_data *d, apop_model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Input a data point in canonical form and a model; returns the area of the model's PDF beneath the given point.</p>
<p>By default, I just make random draws from the PDF and return the percentage of those draws beneath or equal to the given point. Many models have closed-form solutions that make no use of random draws.</p>
<p>See also <a class="el" href="structapop__cdf__settings.html">apop_cdf_settings</a>, which is the structure I use to store draws already made (which means the second, third, ... calls to this function will take much less time than the first), the <code>gsl_rng</code>, and the number of draws to be made. These are handled without your involvement, but if you would like to change the number of draws from the default, add this group before calling <a class="el" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a> :</p>
<div class="fragment"><pre class="fragment"><a class="code" href="group__settings.html#ga553b02de4ace5e6f16a8b26da777f9b9">Apop_model_add_group</a>(your_model, <a class="code" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a>, .draws=1e5, .rng=my_rng);
<span class="keywordtype">double</span> cdf_value = <a class="code" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a>(your_data_point, your_model);
</pre></div><p>Here are many examples using common, mostly symmetric distributions.</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;apop.h&gt;</span>


<span class="keywordtype">int</span> main(){
    <span class="comment">//Set up an apop_data set with only one number.</span>
    <span class="comment">//Most of these functions will only look at the first data point encountered.</span>
    <a class="code" href="structapop__data.html">apop_data</a> *onept = <a class="code" href="apop__data_8c.html#ac39d6a56933b6f084328ec5ecd5090d8">apop_data_alloc</a>(1, 1);
    <a class="code" href="group__data__set__get.html#ga1e7ba48032cb438271d57818b85613f2">apop_data_set</a>(onept, .val=23);

    <a class="code" href="structapop__model.html">apop_model</a> *norm = <a class="code" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(<a class="code" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a>, 23, 138.8);
    <span class="keywordtype">double</span> val = <a class="code" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a>(onept, norm);
    assert(fabs(val - 0.5) &lt; 1e-4);

    <span class="keywordtype">double</span> tolerance = 1e-8;
    <span class="comment">//Macroizing the sample routine above:</span>
<span class="preprocessor">    #define model_val_cdf(model, value, cdf_result) {   \</span>
<span class="preprocessor">        apop_data_set(onept, .val=(value));             \</span>
<span class="preprocessor">        assert(fabs((apop_cdf(onept, model))-(cdf_result))&lt; tolerance);   \</span>
<span class="preprocessor">    }</span>
<span class="preprocessor"></span>
    <a class="code" href="structapop__model.html">apop_model</a> *uni = <a class="code" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(<a class="code" href="group__models.html#ga95be4cc3931072118a7c8ffece73fbe1">apop_uniform</a>, 20, 26);
    model_val_cdf(uni, 0, 0);
    model_val_cdf(uni, 20, 0);
    model_val_cdf(uni, 21, 1./6);
    model_val_cdf(uni, 23, 0.5);
    model_val_cdf(uni, 25, 5./6);
    model_val_cdf(uni, 26, 1);
    model_val_cdf(uni, 260, 1);

    <span class="comment">//Improper uniform always returns 1/2.</span>
    model_val_cdf(&amp;<a class="code" href="group__models.html#ga8b3ad07d082de47bc9cd85661fe9fc4b">apop_improper_uniform</a>, 0, 0.5);
    model_val_cdf(&amp;<a class="code" href="group__models.html#ga8b3ad07d082de47bc9cd85661fe9fc4b">apop_improper_uniform</a>, 228, 0.5);
    model_val_cdf(&amp;<a class="code" href="group__models.html#ga8b3ad07d082de47bc9cd85661fe9fc4b">apop_improper_uniform</a>, INFINITY, 0.5);

    <a class="code" href="structapop__model.html">apop_model</a> *binom = <a class="code" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(<a class="code" href="group__models.html#ga20017e88fda3695f093279c8191f48e3">apop_binomial</a>, 2001, 0.5);
    model_val_cdf(binom, 0, 0);
    model_val_cdf(binom, 1000, .5);
    model_val_cdf(binom, 2000, 1);

    <a class="code" href="structapop__model.html">apop_model</a> *bernie = <a class="code" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(<a class="code" href="group__models.html#gac5437f95ff92d27f389a7b3e27812330">apop_bernoulli</a>, 0.75);
    <span class="comment">//p(0)=.25; p(1)=.75; that determines the CDF.</span>
    <span class="comment">//Notice that the CDF&#39;s integral is over a closed interval.</span>
    model_val_cdf(bernie, -1, 0);
    model_val_cdf(bernie, 0, 0.25);
    model_val_cdf(bernie, 0.1, 0.25);
    model_val_cdf(bernie, .99, 0.25);
    model_val_cdf(bernie, 1, 1);
    model_val_cdf(bernie, INFINITY, 1);

    <span class="comment">//alpha=beta -&gt; symmetry</span>
    <a class="code" href="structapop__model.html">apop_model</a> *beta = <a class="code" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(<a class="code" href="group__models.html#gac11decb2971532ada7d2cd4982848b90">apop_beta</a>, 2, 2);
    model_val_cdf(beta, -INFINITY, 0);
    model_val_cdf(beta, 0.5, 0.5);
    model_val_cdf(beta, INFINITY, 1);

    <span class="comment">//This beta distribution -&gt; uniform</span>
    <a class="code" href="structapop__model.html">apop_model</a> *beta_uni = <a class="code" href="group__models.html#ga36cae46a2950eb6cfb65794cdd5dac7e">apop_model_set_parameters</a>(<a class="code" href="group__models.html#gac11decb2971532ada7d2cd4982848b90">apop_beta</a>, 1, 1);
    model_val_cdf(beta_uni, 0, 0);
    model_val_cdf(beta_uni, 1./6, 1./6);
    model_val_cdf(beta_uni, 0.5, 0.5);
    model_val_cdf(beta_uni, 1, 1);


    beta_uni-&gt;<a class="code" href="structapop__model.html#a74eefdeb90f135027ed64e74802bab12">cdf</a> = NULL; <span class="comment">//With no closed-form CDF; make random draws to estimate the CDF.</span>
    <a class="code" href="group__settings.html#ga553b02de4ace5e6f16a8b26da777f9b9">Apop_model_add_group</a>(beta_uni, <a class="code" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a>, .draws=1e6); <span class="comment">//extra draws to improve accuracy, but we have to lower our tolerance anyway.</span>
    tolerance=1e-3;
    model_val_cdf(beta_uni, 0, 0);
    model_val_cdf(beta_uni, 1./6, 1./6);
    model_val_cdf(beta_uni, 0.5, 0.5);
    model_val_cdf(beta_uni, 1, 1);


    <span class="comment">//sum of three symmetric distributions: still symmetric.</span>
    <a class="code" href="structapop__model.html">apop_model</a> *sum_of_three = <a class="code" href="types_8h.html#a40bb98b02fde8f8e4ab59a4d127b692f">apop_model_mixture</a>(beta, &amp;<a class="code" href="group__models.html#ga8b3ad07d082de47bc9cd85661fe9fc4b">apop_improper_uniform</a>, beta_uni);
    model_val_cdf(sum_of_three, 0.5, 0.5);


    <a class="code" href="structapop__data.html">apop_data</a> *threepts = <a class="code" href="types_8h.html#ad6be56d710a63aa1ceadf2242c553905">apop_data_fill</a>(<a class="code" href="apop__data_8c.html#ac39d6a56933b6f084328ec5ecd5090d8">apop_data_alloc</a>(3,1),
                             -1, 0, 1);
    <a class="code" href="structapop__model.html">apop_model</a> *kernels = <a class="code" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a>(threepts, <a class="code" href="group__models.html#gaded18b6bf8bd63a53f7b72ed5f27fdb5">apop_kernel_density</a>);
    model_val_cdf(kernels, -5, 0);
    model_val_cdf(kernels, 0, 0.5);
    model_val_cdf(kernels, 10, 1);
}
</pre></div> 
</div>
</div>
<a class="anchor" id="gaca737ed521192a76a307bbf825ab4a97"></a><!-- doxytag: member="apop_model.c::apop_draw" ref="gaca737ed521192a76a307bbf825ab4a97" args="(double *out, gsl_rng *r, apop_model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__models.html#gaca737ed521192a76a307bbf825ab4a97">apop_draw</a> </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_rng *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Draw from a model. If the model has its own RNG, then you're good to go; if not, use <a class="el" href="stats_8h.html#ad422a97e52c70bacb585a9f27a987d23">apop_arms_draw</a> to generate random draws.</p>
<p>That function has a lot of caveats: most notably, the input data will be univariate, and your likelihood function must be nonnegative and sum to one. If those aren't appropriate, then don't use this default. [A more forgiving default is on the to-do list.] </p>

</div>
</div>
<a class="anchor" id="ga0a3be4075a89f7119be95a4718e01ade"></a><!-- doxytag: member="apop_model.c::apop_estimate" ref="ga0a3be4075a89f7119be95a4718e01ade" args="(apop_data *d, apop_model m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapop__model.html">apop_model</a>* <a class="el" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a>&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>estimate the parameters of a model given data.</p>
<p>This function copies the input model, preps it, and calls <code>m.estimate(d,&amp;m)</code>. If your model has no <code>estimate</code> method, then I assume <code>apop_maximum_likelihood(d, m)</code>, with the default MLE params.</p>
<p>I assume that you are using this function rather than directly calling the model's the <code>estimate</code> method directly. For example, the <code>estimate</code> method may assume that <code>apop_prep</code> has already been called.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The data </td></tr>
    <tr><td class="paramname">m</td><td>The model </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to an output model, which typically matches the input model but has its <code>parameters</code> element filled in. </dd></dl>

</div>
</div>
<a class="anchor" id="ga5e160c8d0a0ee660c89fb3f6de2af89c"></a><!-- doxytag: member="apop_model.c::apop_log_likelihood" ref="ga5e160c8d0a0ee660c89fb3f6de2af89c" args="(apop_data *d, apop_model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="group__models.html#ga5e160c8d0a0ee660c89fb3f6de2af89c">apop_log_likelihood</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Find the log likelihood of a data/parametrized model pair.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The data </td></tr>
    <tr><td class="paramname">m</td><td>The parametrized model, which must have either a <code>log_likelihood</code> or a <code>p</code> method. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaa86381a72949fd3ffafefa87e3f51a4f"></a><!-- doxytag: member="apop_model.c::apop_model_clear" ref="gaa86381a72949fd3ffafefa87e3f51a4f" args="(apop_data *data, apop_model *model)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapop__model.html">apop_model</a>* <a class="el" href="group__models.html#gaa86381a72949fd3ffafefa87e3f51a4f">apop_model_clear</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Allocate an <a class="el" href="structapop__model.html">apop_model</a>.</p>
<p>This sets up the output elements of the <code><a class="el" href="structapop__model.html">apop_model</a>:</code> the parameters and info.</p>
<p>At close, the input model has parameters of the correct size.</p>
<ul>
<li>This is the default action for <a class="el" href="group__models.html#ga373ccc4cb87b162d62d07a2685ccd8ba">apop_prep</a>. If your model has its own <code>prep</code> method, then that gets used instead, but most don't (or call <a class="el" href="group__models.html#gaa86381a72949fd3ffafefa87e3f51a4f">apop_model_clear</a> at the end of their prep routine).</li>
</ul>
<ul>
<li><a class="el" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a> calls <a class="el" href="group__models.html#ga373ccc4cb87b162d62d07a2685ccd8ba">apop_prep</a> internally.</li>
</ul>
<p>The above two points mean that you probably don't need to call this function directly.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>If your params vary with the size of the data set, then the function needs a data set to calibrate against. Otherwise, it's OK to set this to <code>NULL</code>. </td></tr>
    <tr><td class="paramname">model</td><td>The model whose output elements will be modified. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to the same model, should you need it. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">outmodel-&gt;error=='d'</td><td>dimension error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga14f2bd54421fd6629baccb8a41ecd304"></a><!-- doxytag: member="apop_model.c::apop_model_copy" ref="ga14f2bd54421fd6629baccb8a41ecd304" args="(apop_model in)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapop__model.html">apop_model</a>* <a class="el" href="group__models.html#ga14f2bd54421fd6629baccb8a41ecd304">apop_model_copy</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a>&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Outputs a copy of the <a class="el" href="structapop__model.html">apop_model</a> input. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>The model to be copied </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to a copy of the original, which you can mangle as you see fit.</dd></dl>
<ul>
<li>If <code>in.more_size &gt; 0</code> I <code>memcpy</code> the <code>more</code> pointer from the original data set.</li>
</ul>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">out-&gt;error=='a'</td><td>Allocation error. In extreme cases, where there aren't even a few hundred bytes available, I will return <code>NULL</code>. </td></tr>
    <tr><td class="paramname">out-&gt;error=='s'</td><td>Error copying settings groups. </td></tr>
    <tr><td class="paramname">out-&gt;error=='p'</td><td>Error copying parameters or info page; the given <a class="el" href="gentle.html#apop_data">apop_data</a> struct may be <code>NULL</code> or may have its own <code>-&gt;error</code> element. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gab29755a86b82dfe31cdd01d55431cc09"></a><!-- doxytag: member="apop_model.c::apop_model_free" ref="gab29755a86b82dfe31cdd01d55431cc09" args="(apop_model *free_me)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__models.html#gab29755a86b82dfe31cdd01d55431cc09">apop_model_free</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>free_me</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Free an <a class="el" href="structapop__model.html">apop_model</a> structure.</p>
<p>The <code>parameters</code> element is freed. These are all the things that are completely copied, by <code>apop_model_copy</code>, so the parent model is still safe after this is called. <code>data</code> is not freed, because the odds are you still need it.</p>
<p>If <code>free_me-&gt;more_size</code> is positive, the function runs <code>free(free_me-&gt;more)</code>. But it has no idea what the <code>more</code> element contains; if it points to other structures (like an <a class="el" href="gentle.html#apop_data">apop_data</a> set), you need to free them before calling this function.</p>
<ul>
<li>If <code>free_me</code> is <code>NULL</code>, this does nothing.</li>
</ul>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">free_me</td><td>A pointer to the model to be freed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga2510c7df8ccd834732ee208005738b0f"></a><!-- doxytag: member="apop_model.c::apop_p" ref="ga2510c7df8ccd834732ee208005738b0f" args="(apop_data *d, apop_model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="group__models.html#ga2510c7df8ccd834732ee208005738b0f">apop_p</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Find the probability of a data/parametrized model pair.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The data </td></tr>
    <tr><td class="paramname">m</td><td>The parametrized model, which must have either a <code>log_likelihood</code> or a <code>p</code> method. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga92355da54ab91a8dee22192ae68a37d0"></a><!-- doxytag: member="apop_model.c::apop_parameter_model" ref="ga92355da54ab91a8dee22192ae68a37d0" args="(apop_data *d, apop_model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapop__model.html">apop_model</a>* <a class="el" href="group__models.html#ga92355da54ab91a8dee22192ae68a37d0">apop_parameter_model</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get a model describing the distribution of the given parameter estimates.</p>
<p>For many models, the parameter estimates are well-known, such as the <img class="formulaInl" alt="$t$" src="form_10.png"/>-distribution of the parameters for OLS.</p>
<p>For models where the distribution of <img class="formulaInl" alt="$\hat{}p$" src="form_40.png"/> is not known, if you give me data, I will return a <a class="el" href="group__models.html#ga297c2dc8dbdf4ae93fc7e10860400466">apop_normal</a> or <a class="el" href="group__models.html#ga3a4389e6e2a1a2ea606f89d55ec558d3">apop_multivariate_normal</a> model, using the parameter estimates as mean and <a class="el" href="stats_8h.html#aed343e0e790bd7e1fd1e455d23e394b2">apop_bootstrap_cov</a> for the variances.</p>
<p>If you don't give me data, then I will assume that this is a stochastic model where re-running the model will produce different parameter estimates each time. In this case, I will run the model 1e4 times and return a <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a> model with the resulting parameter distributions.</p>
<p>Before calling this, I expect that you have already run <a class="el" href="group__models.html#ga0a3be4075a89f7119be95a4718e01ade">apop_estimate</a> to produce <img class="formulaInl" alt="$\hat{}p$" src="form_40.png"/>.</p>
<p>The <a class="el" href="structapop__pm__settings.html">apop_pm_settings</a> structure dictates details of how the model is generated. For example, if you want only the distribution of the third parameter, and you know the distribution will be a PMF generated via random draws, then set settings and call the model via: </p>
<div class="fragment"><pre class="fragment">    apop_model_group_add(your_model, apop_pm, .index =3, .draws=3e5);
    <a class="code" href="structapop__model.html">apop_model</a> *dist = <a class="code" href="group__models.html#ga92355da54ab91a8dee22192ae68a37d0">apop_parameter_model</a>(your_data, your_model);
</pre></div><ul>
<li><code>index</code> gives the position of the parameter (in <a class="el" href="group__conversions.html#ga7e31798ab418cbfc7488eaba27dad2af">apop_data_pack</a> order) in which you are interested. Thus, if this is zero or more, then you will get a univariate output distribution describing a single parameter. If <code>index == -1</code>, then I will give you the multivariate distribution across all parameters. The default is zero (i.e. the univariate distribution of the zeroth parameter).</li>
</ul>
<ul>
<li><code>rng</code> If the method requires random draws (as the default bootstrap will), then use this. If you provide <code>NULL</code> and one is needed, see the <a class="el" href="autorng.html">Auto-allocated RNGs</a> section on how one is provided for you.</li>
</ul>
<ul>
<li><code>draws</code> If there is no closed-form solution and bootstrap is inappropriate, then the last resort is a large numbr of random draws of the model, summarized into a PMF. Default: 1,000 draws. </li>
</ul>

</div>
</div>
<a class="anchor" id="ga867f0b8df261866bb18e9040871c51f0"></a><!-- doxytag: member="apop_model.c::apop_predict" ref="ga867f0b8df261866bb18e9040871c51f0" args="(apop_data *d, apop_model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapop__data.html">apop_data</a>* <a class="el" href="group__models.html#ga867f0b8df261866bb18e9040871c51f0">apop_predict</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A prediction supplies E(a missing value | original data, already-estimated parameters, and other supplied data elements ).</p>
<p>For a regression, one would first estimate the parameters of the model, then supply a row of predictors <b>X</b>. The value of the dependent variable <img class="formulaInl" alt="$y$" src="form_41.png"/> is unknown, so the system would predict that value. [In some models, this may not be the expected value, but is a best value for the missing item using some other meaning of `best'.]</p>
<p>For a univariate model (i.e. a model in one-dimensional data space), there is only one variable to omit and fill in, so the prediction problem reduces to the expected value: E(a missing value | original data, already-estimated parameters).</p>
<p>In other cases, prediction is the missing data problem: for three-dimensional data, you may supply the input (34, <code>NaN</code>, 12), and the parameterized model provides the most likely value of the middle parameter.</p>
<ul>
<li>If you give me a <code>NULL</code> data set, I will assume you want all values filled in---the expected value.</li>
</ul>
<ul>
<li>If you give me data with <code>NaNs</code>, I will take those as the points to be predicted given the provided data.</li>
</ul>
<p>If the model has no <code>predict</code> method, the default is to use the <a class="el" href="asst_8h.html#a2a184259c139f1fdd970ef6b43f6274e">apop_ml_impute</a> function to do the work.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>If you gave me a non-<code>NULL</code> data set, I will return that, with the zeroth column or the <code>NaNs</code> filled in. If <code>NULL</code> input, I will allocate an <a class="el" href="gentle.html#apop_data">apop_data</a> set and fill it with the expected values.</dd></dl>
<p>There may be a second page (i.e., a <a class="el" href="gentle.html#apop_data">apop_data</a> set attached to the <code>-&gt;more</code> pointer of the main) listing confidence and standard error information. See your specific model documentation for details.</p>
<p>This segment of the framework is in beta---subject to revision of the details. </p>

</div>
</div>
<a class="anchor" id="ga373ccc4cb87b162d62d07a2685ccd8ba"></a><!-- doxytag: member="apop_model.c::apop_prep" ref="ga373ccc4cb87b162d62d07a2685ccd8ba" args="(apop_data *d, apop_model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__models.html#ga373ccc4cb87b162d62d07a2685ccd8ba">apop_prep</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The default prep is to simply call <a class="el" href="group__models.html#gaa86381a72949fd3ffafefa87e3f51a4f">apop_model_clear</a>. If the function has a prep method, then that gets called instead. </p>

</div>
</div>
<a class="anchor" id="ga228b013bc80f308900882312cab93eb3"></a><!-- doxytag: member="apop_model.c::apop_score" ref="ga228b013bc80f308900882312cab93eb3" args="(apop_data *d, gsl_vector *out, apop_model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__models.html#ga228b013bc80f308900882312cab93eb3">apop_score</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Find the vector of derivatives of the log likelihood of a data/parametrized model pair.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The data </td></tr>
    <tr><td class="paramname">out</td><td>The score to be returned. I expect you to have allocated this already. </td></tr>
    <tr><td class="paramname">m</td><td>The parametrized model, which must have either a <code>log_likelihood</code> or a <code>p</code> method. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<p><p>
<div class="tiny">Autogenerated by doxygen on Fri May 17 2013.</div></body></html>
